\hypertarget{intersection__model_8cpp_source}{}\doxysection{intersection\+\_\+model.\+cpp}
\label{intersection__model_8cpp_source}\index{intersection\_model/src/intersection\_model.cpp@{intersection\_model/src/intersection\_model.cpp}}
\mbox{\hyperlink{intersection__model_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{intersection__model_8h}{intersection\_model.h}}"{}}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00003}00003 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespaceintersection__model}{intersection\_model}}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00004}00004 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00005}00005 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00006}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a67836f52e7223d46b2ec0fe0227e4160}{00006}}     \mbox{\hyperlink{classintersection__model_1_1intersection__model}{intersection\_model::intersection\_model}}(\textcolor{keyword}{const} std::string \&intersection\_name, \textcolor{keyword}{const} \textcolor{keywordtype}{int} intersection\_id, \textcolor{keyword}{const} std::string \&osm\_file\_path )\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00007}00007         initialization(intersection\_name, intersection\_id, osm\_file\_path);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00008}00008     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00010}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a3c83614bebf32e0f192e43b2cd384e30}{00010}}     \textcolor{keywordtype}{void} intersection\_model::initialization(\textcolor{keyword}{const} std::string \&intersection\_name, \textcolor{keyword}{const} \textcolor{keywordtype}{int} intersection\_id,\textcolor{keyword}{const} std::string \&osm\_file\_path)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00011}00011     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00012}00012         }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00013}00013         int\_info.intersection\_name = intersection\_name;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00014}00014         int\_info.intersection\_id = intersection\_id; }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00015}00015         read\_lanelet2\_map(osm\_file\_path);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00016}00016         \textcolor{keywordflow}{if} (map \&\& !map-\/>empty())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00017}00017         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00018}00018             SPDLOG\_INFO(\textcolor{stringliteral}{"{}Map is loaded ..."{}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00019}00019 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00020}00020             \textcolor{keywordflow}{if}(update\_intersection\_info())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00021}00021             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00022}00022                 SPDLOG\_INFO(\textcolor{stringliteral}{"{}Intersection information is initialized ..."{}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00023}00023             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00024}00024             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00025}00025             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00026}00026                 SPDLOG\_INFO(\textcolor{stringliteral}{"{}Cannot initialize intersection information."{}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00027}00027             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00028}00028         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00029}00029         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00030}00030         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00031}00031             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Loading Map Failed."{}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00032}00032         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00033}00033 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00034}00034         SPDLOG\_INFO(\textcolor{stringliteral}{"{}Initialization Done!"{}});  }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00035}00035     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00037}00037 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00038}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a96cf039df5fc9902a44258e73e81f67b}{00038}}     \textcolor{keywordtype}{void} intersection\_model::read\_lanelet2\_map( std::string filename ) }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00039}00039     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00040}00040         \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00041}00041         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00042}00042             \textcolor{keywordtype}{int} projector\_type = 1;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00043}00043             std::string target\_frame;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00044}00044             lanelet::ErrorMessages errors;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00046}00046             \textcolor{comment}{// Parse geo reference info from the lanelet map (.osm)}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00047}00047             lanelet::io\_handlers::AutowareOsmParser::parseMapParams(filename, \&projector\_type, \&target\_frame);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00048}00048             projector = \textcolor{keyword}{new} lanelet::projection::LocalFrameProjector(target\_frame.c\_str());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00049}00049             map = lanelet::load(filename, *projector, \&errors);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00050}00050         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00051}00051         \textcolor{keywordflow}{catch}(\textcolor{keyword}{const} lanelet::LaneletError \&ex)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00052}00052         \{         }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00053}00053             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Cannot read osm file \{0\}. Error message: \{1\} "{}}, filename, ex.what());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00054}00054             exit(1);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00055}00055         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00056}00056     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00058}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a3b97832c22d8c30c2530e1f523c809b6}{00058}}     lanelet::LaneletMapPtr intersection\_model::get\_lanelet2\_map() \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00059}00059         \textcolor{keywordflow}{return} map;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00060}00060     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00062}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a5bba3dd07a77fa83c09a5b49751fcaae}{00062}}     lanelet::Lanelet intersection\_model::get\_lanelet( \textcolor{keywordtype}{double} lat, \textcolor{keywordtype}{double} lon ) }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00063}00063     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00064}00064         SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Getting lanelet for (\{0\},\{1\}"{}}, lat, lon);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00065}00065         lanelet::GPSPoint gps;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00066}00066         gps.ele = 0;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00067}00067         gps.lat = lat;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00068}00068         gps.lon = lon;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00069}00069         lanelet::BasicPoint3d point = projector-\/>forward(gps);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00070}00070 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00071}00071         lanelet::BasicPoint2d point2d = lanelet::utils::to2D(point );}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00072}00072         }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00073}00073         std::vector<lanelet::Lanelet> lanelets = map-\/>laneletLayer.nearest(point2d,1);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00074}00074         \textcolor{keywordflow}{return} lanelets.front();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00075}00075     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00077}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a2356a55b5dd997c37d63e84581f44559}{00077}}     \textcolor{keywordtype}{bool} intersection\_model::update\_vehicle\_routing\_graph()}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00078}00078     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00079}00079         \textcolor{comment}{//get routingGraph from map}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00080}00080         lanelet::traffic\_rules::TrafficRulesPtr trafficRules\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00081}00081             lanelet::traffic\_rules::TrafficRulesFactory::create(lanelet::Locations::Germany,}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00082}00082                                                         lanelet::Participants::Vehicle,}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00083}00083                                                         lanelet::traffic\_rules::TrafficRules::Configuration())\};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00084}00084         lanelet::routing::RoutingCostPtrs costPtrs\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00085}00085             std::make\_shared<lanelet::routing::RoutingCostDistance>(this-\/>laneChangeCost, this-\/>minLaneChangeLength),}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00086}00086             std::make\_shared<lanelet::routing::RoutingCostTravelTime>(this-\/>laneChangeCost)\};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00087}00087         lanelet::routing::RoutingGraph::Configuration configuration;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00088}00088         configuration.insert(std::make\_pair(lanelet::routing::RoutingGraph::ParticipantHeight, this-\/>participantHeight));}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00089}00089         this-\/>vehicleGraph\_ptr = lanelet::routing::RoutingGraph::build(*this-\/>map, *trafficRules, costPtrs, configuration);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00090}00090         \textcolor{keywordflow}{if} ( !this-\/>vehicleGraph\_ptr )}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00091}00091         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00092}00092             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00093}00093         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00094}00094         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00095}00095     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00097}\mbox{\hyperlink{classintersection__model_1_1intersection__model_aee444e73411f8593b4ad579849fc87b7}{00097}}     \textcolor{keywordtype}{bool} intersection\_model::update\_intersection\_info()}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00098}00098     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00099}00099         \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00100}00100         \{         }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00101}00101             \textcolor{comment}{//Find the all\_way\_stop regulatory element}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00102}00102             lanelet::RegulatoryElementLayer \&reg\_layer = this-\/>map-\/>regulatoryElementLayer;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00103}00103             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} reg\_element\_itr = reg\_layer.begin(); reg\_element\_itr != reg\_layer.end(); reg\_element\_itr++)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00104}00104             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00105}00105                 lanelet::RegulatoryElement *reg\_element\_ptr = reg\_element\_itr-\/>get();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00106}00106 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00107}00107                 \textcolor{keywordflow}{if} (reg\_element\_ptr-\/>attribute(lanelet::AttributeName::Subtype) == lanelet::AttributeValueString::AllWayStop)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00108}00108                 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00109}00109                     \textcolor{keywordflow}{if} (!update\_intersection\_info\_by\_all\_way\_stop\_reg(reg\_element\_ptr))}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00110}00110                     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00111}00111                          SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Failed to load intersection information based on all\_way\_stop regulatory element."{}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00112}00112                     \};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00113}00113                 \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00114}00114             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00115}00115         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00116}00116         \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} lanelet::LaneletError \&ex)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00117}00117         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00118}00118             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Failed to call get\_routing\_graph() : \{0\}"{}}, ex.what());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00119}00119             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00120}00120         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00121}00121 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00122}00122         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00123}00123     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00125}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a2bfd4216fee2946a52babc8eb008c975}{00125}}     \textcolor{keywordtype}{bool} intersection\_model::update\_intersection\_info\_by\_all\_way\_stop\_reg(\textcolor{keyword}{const} lanelet::RegulatoryElement *all\_way\_stop\_reg\_elem\_ptr)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00126}00126     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00127}00127         \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00128}00128         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00129}00129             \textcolor{comment}{//get all entering lanelet based on all\_way\_stop regulatory elements}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00130}00130             lanelet::RegulatoryElementDataConstPtr coreData = all\_way\_stop\_reg\_elem\_ptr-\/>constData();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00131}00131             lanelet::RuleParameterMap rule\_map = coreData-\/>parameters;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00132}00132             lanelet::RegulatoryElement::iterator rule\_map\_itr = rule\_map.begin();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00134}00134             \textcolor{keywordflow}{while} (rule\_map\_itr != rule\_map.end())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00135}00135             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00137}00137                 \textcolor{comment}{//Find all entry lanelets participating in the 4-\/way stop by role='yield'}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00138}00138                 \textcolor{keywordflow}{if} (rule\_map\_itr-\/>first == lanelet::RoleNameString::Yield)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00139}00139                 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00140}00140                     lanelet::RuleParameters::iterator rule\_params\_itr = rule\_map\_itr-\/>second.begin();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00141}00141                     \textcolor{keywordflow}{while} (rule\_params\_itr != rule\_map\_itr-\/>second.end())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00142}00142                     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00143}00143                         \textcolor{keyword}{auto} lanelet\_apply\_rule = boost::get<lanelet::WeakLanelet>(*rule\_params\_itr);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00144}00144                         \textcolor{keywordflow}{if} (!lanelet\_apply\_rule.expired())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00145}00145                         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00146}00146                             \textcolor{keyword}{auto} entry\_lanelet = lanelet\_apply\_rule.lock();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00147}00147                             \mbox{\hyperlink{structintersection__model_1_1lanelet__info__t}{lanelet\_info\_t}} lanelet\_info\_entry;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00148}00148                             lanelet\_info\_entry.\mbox{\hyperlink{structintersection__model_1_1lanelet__info__t_a8657dcadd09f1207854926e31adb29c7}{id}}           = entry\_lanelet.id();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00149}00149                             lanelet\_info\_entry.\mbox{\hyperlink{structintersection__model_1_1lanelet__info__t_af7d913fce176218be34fe9dface89cb6}{speed\_limit}}  = get\_speed\_limit\_by\_lanelet(entry\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00150}00150                             lanelet\_info\_entry.\mbox{\hyperlink{structintersection__model_1_1lanelet__info__t_ac750881374f43a6427ba0d3716243105}{length}}       = lanelet::geometry::length3d(entry\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00151}00151                             this-\/>int\_info.entering\_lanelets\_info.push\_back(lanelet\_info\_entry);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00152}00152 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00153}00153                             update\_link\_departure\_lanelets\_info\_by\_entry\_lanelet(entry\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00154}00154                             entering\_lanelets.push\_back(entry\_lanelet);                           }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00155}00155                         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00156}00156                         rule\_params\_itr++;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00157}00157                     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00158}00158                 \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00159}00159                 rule\_map\_itr++;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00160}00160             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00161}00161         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00162}00162         \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} lanelet::LaneletError \&ex)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00163}00163         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00164}00164             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Failed to call load intersection information: \{0\}"{}}, ex.what());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00165}00165             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00166}00166         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00167}00167         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00168}00168     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00169}00169 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00170}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a5cf97605f6557f75d1452da9536e7118}{00170}}     \textcolor{keywordtype}{bool} intersection\_model::update\_link\_departure\_lanelets\_info\_by\_entry\_lanelet(\textcolor{keyword}{const} lanelet::Lanelet \&entry\_lanelet)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00171}00171     \{    }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00172}00172         \textcolor{keywordtype}{bool} is\_updated= \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00173}00173         \textcolor{comment}{//making sure the vehicle routing graph is not null}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00174}00174         \textcolor{keywordflow}{if}( !this-\/>vehicleGraph\_ptr )}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00175}00175         \{ }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00176}00176             \textcolor{keywordflow}{if}( !update\_vehicle\_routing\_graph() ) }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00177}00177             \{ }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00178}00178                 \textcolor{keywordflow}{return} is\_updated;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00179}00179             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00180}00180         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00181}00181 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00182}00182         \textcolor{comment}{//Retrieve all the possible link lanelets for the entry lanelet}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00183}00183         lanelet::ConstLanelets link\_lanelets\_per\_entering\_lanelet = this-\/>vehicleGraph\_ptr-\/>following(entry\_lanelet, \textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00184}00184 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00185}00185         \textcolor{comment}{//Every entry lanelet at the intersection has at most three link lanelets}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00186}00186         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&link\_lanelet : link\_lanelets\_per\_entering\_lanelet)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00187}00187         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00188}00188             \mbox{\hyperlink{structintersection__model_1_1lanelet__info__t}{lanelet\_info\_t}} lanelet\_info\_link;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00189}00189             lanelet\_info\_link.\mbox{\hyperlink{structintersection__model_1_1lanelet__info__t_a8657dcadd09f1207854926e31adb29c7}{id}} = link\_lanelet.id();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00190}00190             lanelet\_info\_link.\mbox{\hyperlink{structintersection__model_1_1lanelet__info__t_af7d913fce176218be34fe9dface89cb6}{speed\_limit}} = get\_speed\_limit\_by\_lanelet(link\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00191}00191             lanelet\_info\_link.\mbox{\hyperlink{structintersection__model_1_1lanelet__info__t_ac750881374f43a6427ba0d3716243105}{length}}      = lanelet::geometry::length3d(link\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00192}00192             this-\/>int\_info.link\_lanelets\_info.push\_back(lanelet\_info\_link);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00193}00193             link\_lanelets.push\_back(link\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00194}00194             }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00195}00195             \textcolor{comment}{//Updating connecting lanelet ids for entering lanelet}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00196}00196             std::for\_each(this-\/>int\_info.entering\_lanelets\_info.begin(), this-\/>int\_info.entering\_lanelets\_info.end(), [link\_lanelet, entry\_lanelet](\textcolor{keyword}{auto}\& ref)\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00197}00197                 if(ref.id == entry\_lanelet.id())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00198}00198                 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00199}00199                     ref.connecting\_lanelet\_ids.push\_back(link\_lanelet.id());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00200}00200                 \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00201}00201             \});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00202}00202 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00203}00203             \textcolor{comment}{//Only one departure lanelet per link lanelet}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00204}00204             \mbox{\hyperlink{structintersection__model_1_1lanelet__info__t}{lanelet\_info\_t}} lanelet\_info\_depart;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00205}00205             lanelet::ConstLanelet depart\_lanelet = this-\/>vehicleGraph\_ptr-\/>following(link\_lanelet, \textcolor{keyword}{false}).front();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00206}00206             lanelet\_info\_depart.\mbox{\hyperlink{structintersection__model_1_1lanelet__info__t_a8657dcadd09f1207854926e31adb29c7}{id}} = depart\_lanelet.id();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00207}00207             lanelet\_info\_depart.speed\_limit = get\_speed\_limit\_by\_lanelet(depart\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00208}00208             lanelet\_info\_depart.length      = lanelet::geometry::length3d(depart\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00209}00209             this-\/>int\_info.departure\_lanelets\_info.insert(lanelet\_info\_depart);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00210}00210            }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00211}00211             \textcolor{comment}{//If the departure lanelet with the same lanelet id already exist in the list, do not add this lanelet into the list}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00212}00212             \textcolor{keywordtype}{bool} is\_exist = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00213}00213             \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& subj\_dpl: departure\_lanelets)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00214}00214             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00215}00215                 \textcolor{keywordflow}{if}(subj\_dpl.id() == depart\_lanelet.id())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00216}00216                 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00217}00217                     is\_exist = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00218}00218                 \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00219}00219             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00220}00220 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00221}00221             \textcolor{keywordflow}{if}(!is\_exist)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00222}00222             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00223}00223                 departure\_lanelets.push\_back(depart\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00224}00224             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00225}00225             is\_updated = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00226}00226         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00227}00227         \textcolor{keywordflow}{return} is\_updated;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00228}00228     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00229}00229 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00230}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a3deb407fbd9c48e6ad4e2ced720cabb0}{00230}}     \textcolor{keyword}{const} \mbox{\hyperlink{structintersection__model_1_1intersection__info__t}{intersection\_info\_t}}\& intersection\_model::get\_intersection\_info()\textcolor{keyword}{ const }}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00231}00231 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00232}00232         \textcolor{keywordflow}{return} this-\/>int\_info;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00233}00233     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00234}00234 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00235}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a332baac17fc17875f98425e734f7b1e7}{00235}}    \textcolor{keyword}{const}  std::vector<lanelet\_info\_t>\& intersection\_model::get\_entry\_lanelets\_info()\textcolor{keyword}{ const }}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00236}00236 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00237}00237         \textcolor{keywordflow}{return} this-\/>int\_info.\mbox{\hyperlink{structintersection__model_1_1intersection__info__t_aaec275e8e8b2d9ab62c83f6e04087f15}{entering\_lanelets\_info}};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00238}00238     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00239}00239 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00240}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a480e7966ce3d9bd7422f1d59fcf6bae0}{00240}}     \textcolor{keywordtype}{double} intersection\_model::get\_speed\_limit\_by\_lanelet(\textcolor{keyword}{const} lanelet::ConstLanelet \&subj\_lanelet)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00241}00241 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00242}00242         \textcolor{keywordtype}{double} speed\_limit\_result = 0;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00243}00243         std::regex r(\textcolor{stringliteral}{"{}[0-\/9]+"{}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00244}00244         lanelet::RegulatoryElementConstPtrs reg\_elements = subj\_lanelet.regulatoryElements();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00245}00245 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00246}00246 \textcolor{comment}{        /***}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00247}00247 \textcolor{comment}{         * Identify the speed limit regulatory element by using an attribute with a key value that equals to 'limit'.}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00248}00248 \textcolor{comment}{         * The value of this attribute stores the speed limit value in unit of measure MPH}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00249}00249 \textcolor{comment}{        **/}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00250}00250         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} itr = reg\_elements.begin(); itr != reg\_elements.end(); itr++)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00251}00251         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00252}00252             lanelet::AttributeMap attr\_map = itr-\/>get()-\/>attributes();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00253}00253             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} inner\_itr = attr\_map.begin(); inner\_itr != attr\_map.end(); inner\_itr++)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00254}00254             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00255}00255                 \textcolor{keywordflow}{if} (inner\_itr-\/>first == lanelet::DigitalSpeedLimit::Limit)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00256}00256                 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00257}00257                     std::string speed\_str = inner\_itr-\/>second.value();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00258}00258                     \textcolor{keywordflow}{if} (std::regex\_search(speed\_str, r))}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00259}00259                     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00260}00260                         speed\_limit\_result = std::stod(std::regex\_replace(speed\_str, std::regex(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)s"{}}), std::string(\textcolor{stringliteral}{"{}"{}})));}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00261}00261                         speed\_limit\_result *= MPH\_TO\_MS; \textcolor{comment}{//MPH to M/S conversion}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00262}00262                     \};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00263}00263                 \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00264}00264             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00265}00265         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00266}00266         \textcolor{keywordflow}{return} speed\_limit\_result;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00267}00267     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00269}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a29c8437e12de93e4c9860fbf09a4bc4e}{00269}}    \textcolor{keyword}{const}  std::vector<lanelet\_info\_t>\& intersection\_model::get\_link\_lanelets\_info()\textcolor{keyword}{ const }}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00270}00270 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00271}00271         \textcolor{keywordflow}{return} this-\/>int\_info.link\_lanelets\_info;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00272}00272     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00273}00273 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00274}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a6ec7708265368ee4240cb057193ad568}{00274}}     \textcolor{keyword}{const} std::vector<lanelet\_info\_t> intersection\_model::get\_conflict\_lanelets\_info(int64\_t sub\_link\_lanelet\_id)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00275}00275     \{       }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00276}00276         \textcolor{comment}{//Check the subject link\_lanelet conflict by comparing it to all link lanelets at the intersection}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00277}00277         lanelet::Id subject\_link\_lanelet\_id\{sub\_link\_lanelet\_id\};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00278}00278         lanelet::Points2d intersectionPts;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00279}00279         std::vector<lanelet\_info\_t> conflict\_lanelets;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00280}00280 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00281}00281         \textcolor{keywordflow}{if} ( !is\_valid\_link\_lanelet\_id(sub\_link\_lanelet\_id) )}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00282}00282         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00283}00283             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Not a valid input link lanelet id \{0\}."{}}, sub\_link\_lanelet\_id);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00284}00284             \textcolor{keywordflow}{return} conflict\_lanelets;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00285}00285         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00286}00286 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00287}00287         \textcolor{comment}{//Get the vector of link lanelets at the intersection that share the same entry lanelet. }}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00288}00288         \textcolor{comment}{//The vector of link lanelets can be skipped.}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00289}00289         std::vector<int> lanelet\_ids\_to\_skip = get\_shared\_entry\_link\_lanelet\_ids(sub\_link\_lanelet\_id);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00291}00291         \textcolor{comment}{//get lanelets from map}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00292}00292         lanelet::LaneletLayer \&lanelets = this-\/>map-\/>laneletLayer;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00293}00293         \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00294}00294         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00295}00295             \textcolor{comment}{//comparing centerline between subject link lanelet and all other link lanelets at the intersection}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00296}00296             lanelet::ConstLineString2d subject\_centerline\_b = lanelets.get(subject\_link\_lanelet\_id).centerline2d();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00297}00297             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& link\_lanelet : this-\/>int\_info.link\_lanelets\_info)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00298}00298             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00299}00299                 \textcolor{keywordflow}{if} (std::find(lanelet\_ids\_to\_skip.begin(), lanelet\_ids\_to\_skip.end(), link\_lanelet.id) != lanelet\_ids\_to\_skip.end())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00300}00300                 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00301}00301                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00302}00302                 \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00303}00303                 lanelet::ConstLineString2d centerline\_link\_lanelet\_b = lanelets.get(link\_lanelet.id).centerline2d();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00304}00304                 lanelet::ConstHybridLineString2d c\_sub(centerline\_link\_lanelet\_b);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00305}00305                 lanelet::ConstHybridLineString2d c(subject\_centerline\_b);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00306}00306 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00307}00307                 boost::geometry::intersection(c, c\_sub, intersectionPts);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00308}00308                 \textcolor{keywordflow}{if} (intersectionPts.size() > 0)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00309}00309                 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00310}00310                     conflict\_lanelets.push\_back(link\_lanelet);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00311}00311                 \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00312}00312                 intersectionPts.clear();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00313}00313             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00314}00314         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00315}00315         \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} lanelet::LaneletError \&ex)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00316}00316         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00317}00317             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Failed to lookup element with id \{0\} : \{1\} "{}} , ex.what() ,sub\_link\_lanelet\_id);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00318}00318             conflict\_lanelets.clear();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00319}00319         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00320}00320         \textcolor{keywordflow}{return} conflict\_lanelets;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00321}00321     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00322}00322 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00323}\mbox{\hyperlink{classintersection__model_1_1intersection__model_aeebb161d09289ec701f6e8a4aec3b7a6}{00323}}     \textcolor{keyword}{const} std::vector<int> intersection\_model::get\_shared\_entry\_link\_lanelet\_ids(int64\_t subject\_link\_lanelet\_id) }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00324}00324     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00325}00325         std::vector<int> lanelet\_ids;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00327}00327         \textcolor{comment}{//If routing graph is not initialized, it will return zero number of lanelet ids.}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00328}00328         \textcolor{keywordflow}{if}( !this-\/>vehicleGraph\_ptr )}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00329}00329         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00330}00330             \textcolor{keywordflow}{if}( !update\_vehicle\_routing\_graph() )}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00331}00331             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00332}00332                 \textcolor{keywordflow}{return} lanelet\_ids;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00333}00333             \};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00334}00334         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00335}00335 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00336}00336         lanelet::ConstLanelet  lanelet\_entry = this-\/>vehicleGraph\_ptr-\/>previous(this-\/>map-\/>laneletLayer.get(subject\_link\_lanelet\_id)).front();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00337}00337         lanelet::ConstLanelets shared\_entry\_link\_lanelets = vehicleGraph\_ptr-\/>following(lanelet\_entry);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00338}00338         }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00339}00339         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} ele\_ptr = shared\_entry\_link\_lanelets.begin(); ele\_ptr != shared\_entry\_link\_lanelets.end(); ele\_ptr++)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00340}00340         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00341}00341             lanelet\_ids.push\_back(ele\_ptr-\/>id());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00342}00342         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00343}00343         \textcolor{keywordflow}{return} lanelet\_ids;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00344}00344     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00345}00345 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00346}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a5de61330c7ff6b874ceea907bdf0a579}{00346}}     \textcolor{keywordtype}{bool} intersection\_model::is\_valid\_link\_lanelet\_id(int64\_t lanelet\_id)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00347}00347     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00348}00348         \textcolor{keywordtype}{bool} is\_link\_lanelet\_id = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00349}00349 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00350}00350         \textcolor{keywordflow}{if}(this-\/>int\_info.link\_lanelets\_info.empty())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00351}00351         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00352}00352             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Intersection information contains zero number of link lanelets."{}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00353}00353             \textcolor{keywordflow}{return} is\_link\_lanelet\_id;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00354}00354         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00356}00356         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& link\_lanelet\_info : this-\/>int\_info.link\_lanelets\_info)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00357}00357         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00358}00358             \textcolor{keywordflow}{if} (lanelet\_id == link\_lanelet\_info.id)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00359}00359             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00360}00360                 is\_link\_lanelet\_id = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00361}00361             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00362}00362         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00364}00364         \textcolor{keywordflow}{return} is\_link\_lanelet\_id;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00365}00365     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00366}00366 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00367}\mbox{\hyperlink{classintersection__model_1_1intersection__model_ab01756af0b2c31c639795a5f04a8adf4}{00367}}     \textcolor{keyword}{const}  std::set<lanelet\_info\_t>\& intersection\_model::get\_departure\_lanelets\_info()\textcolor{keyword}{ const }}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00368}00368 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00369}00369         \textcolor{keywordflow}{return} this-\/>int\_info.departure\_lanelets\_info;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00370}00370     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00371}00371      }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00372}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a9dc2ebcc772b15ece501feb9fff2d01e}{00372}}     \textcolor{keyword}{const} std::shared\_ptr<lanelet::routing::RoutingGraph> intersection\_model::get\_vehicleGraph\_ptr()\textcolor{keyword}{  const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00373}00373 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00374}00374         \textcolor{keywordflow}{return} this-\/>vehicleGraph\_ptr;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00375}00375     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00377}\mbox{\hyperlink{classintersection__model_1_1intersection__model_ab3512b1195acfea750a228f6c4fc2cd0}{00377}}     \textcolor{keywordtype}{bool} intersection\_model::update\_intersecion\_info\_by\_map\_msg(\textcolor{keyword}{const} std::shared\_ptr<intersection\_map> int\_map\_msg)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00378}00378     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00379}00379         \textcolor{keywordtype}{bool} is\_updated = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00380}00380         SPDLOG\_INFO(\textcolor{stringliteral}{"{}Intersection id \{0\} has \{1\} number of geometries."{}}, int\_map\_msg-\/>intersectionid, int\_map\_msg-\/>geometries.size());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00381}00381         \textcolor{keywordflow}{if}(int\_map\_msg-\/>geometries.empty())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00382}00382         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00383}00383             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00384}00384         \}  }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00385}00385         \textcolor{comment}{// Assuming the map msg only has one geometry object}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00386}00386         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& map\_msg\_geometry = int\_map\_msg-\/>geometries.front();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00387}00387         std::unordered\_map<long, lanelet::ConstLanelet> entry\_lane2lanelet\_m;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00388}00388         std::unordered\_map<long, std::vector<map\_connection>> entry\_lane2connections\_m;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00389}00389         std::unordered\_map<long, map\_lane> link\_departure\_lanes\_m; }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00390}00390         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& map\_msg\_lane: map\_msg\_geometry.approach.lanes)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00391}00391         \{    }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00392}00392             \textcolor{comment}{// Lane geometry has to have at least 2 points to form a path/line}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00393}00393             \textcolor{keywordflow}{if}(map\_msg\_lane.nodes.size() < 2)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00394}00394             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00395}00395                 SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Skip processing MAP message lane as lane id: \{0\} has less than 2 nodes. Connection size = \{1\}. Node size = \{2\}."{}}, map\_msg\_lane.lane\_id, map\_msg\_lane.connection.size(), map\_msg\_lane.nodes.size());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00396}00396                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00397}00397             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00398}00398             \textcolor{comment}{//Entry lane includes connection in MAP message. }}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00399}00399             \textcolor{keywordflow}{if}(!map\_msg\_lane.connection.empty() )}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00400}00400             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00401}00401                 \textcolor{comment}{//Mapping MAP message lane id to lanelet id from OSM map}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00402}00402                 mapping\_lane\_id\_2\_lanelet\_id(map\_msg\_geometry.refpoint, map\_msg\_lane, map\_msg\_geometry.approach.width, this-\/>entering\_lanelets, entry\_lane2lanelet\_m);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00403}00403                 entry\_lane2connections\_m.insert(\{map\_msg\_lane.lane\_id,  map\_msg\_lane.connection\});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00404}00404                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00405}00405             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00406}00406             link\_departure\_lanes\_m.insert(\{map\_msg\_lane.lane\_id, map\_msg\_lane\});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00407}00407         \}     }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00408}00408         }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00409}00409         \textcolor{comment}{//Matching enter lanelet, departure lanelet to signal group id}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00410}00410         std::vector<signalized\_intersection\_lanelets> enter\_departure\_lanelets2SG\_id\_v;    }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00411}00411         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& lane: entry\_lane2connections\_m)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00412}00412         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00413}00413             \textcolor{keywordtype}{long} lane\_id = lane.first;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00414}00414             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& entry\_lanelet = entry\_lane2lanelet\_m[lane\_id];}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00415}00415             \textcolor{comment}{//Retrieve all connections for the entry lane}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00416}00416             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& connections = entry\_lane2connections\_m[lane.first];}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00417}00417             \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& conn : connections)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00418}00418             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00419}00419                 \textcolor{comment}{//Find each departure lane for the entry lanelet using connections, and mapping the departure lane id to the above departure lanelet id}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00420}00420                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\&  depart\_lane = link\_departure\_lanes\_m[conn.lane\_id];}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00421}00421                 std::unordered\_map<long, lanelet::ConstLanelet> depart\_lane2lanelet\_m;                }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00422}00422                 mapping\_lane\_id\_2\_lanelet\_id(map\_msg\_geometry.refpoint, depart\_lane, map\_msg\_geometry.approach.width, this-\/>departure\_lanelets ,depart\_lane2lanelet\_m); }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00423}00423                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\&  depart\_lanelet = depart\_lane2lanelet\_m[depart\_lane.lane\_id];}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00424}00424                 int32\_t signal\_group\_id = conn.signalGroup;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00425}00425 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00426}00426                 \mbox{\hyperlink{structintersection__model_1_1signalized__intersection__lanelets}{signalized\_intersection\_lanelets}} temp\_sil; }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00427}00427                 temp\_sil.\mbox{\hyperlink{structintersection__model_1_1signalized__intersection__lanelets_a0c2f6ceb707dd892be5adff4117fbf61}{enter\_lanelet\_id}} = entry\_lanelet.id();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00428}00428                 temp\_sil.\mbox{\hyperlink{structintersection__model_1_1signalized__intersection__lanelets_a42b69d0b8933f6898705be448de69085}{depart\_lanelet\_id}} = depart\_lanelet.id();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00429}00429                 temp\_sil.\mbox{\hyperlink{structintersection__model_1_1signalized__intersection__lanelets_ace46d005dc0799b7639c0b1c9657b505}{signal\_group\_id}} = signal\_group\_id;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00430}00430                 enter\_departure\_lanelets2SG\_id\_v.push\_back(temp\_sil);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00431}00431                 SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Enter\_lanelet\_id = \{0\}, depart\_lanelet\_id = \{1\}, signal group\_id = \{2\}."{}}, temp\_sil.\mbox{\hyperlink{structintersection__model_1_1signalized__intersection__lanelets_a0c2f6ceb707dd892be5adff4117fbf61}{enter\_lanelet\_id}}, temp\_sil.\mbox{\hyperlink{structintersection__model_1_1signalized__intersection__lanelets_a42b69d0b8933f6898705be448de69085}{depart\_lanelet\_id}}, temp\_sil.\mbox{\hyperlink{structintersection__model_1_1signalized__intersection__lanelets_ace46d005dc0799b7639c0b1c9657b505}{signal\_group\_id}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00432}00432             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00433}00433         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00434}00434 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00435}00435         \textcolor{comment}{//Matching intersection link lanelet\_id with signal group id}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00436}00436         std::unordered\_map<lanelet::Id, int32\_t> link\_lanelet2signal\_group\_id\_m;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00437}00437         std::for\_each(enter\_departure\_lanelets2SG\_id\_v.begin(), enter\_departure\_lanelets2SG\_id\_v.end(),[\&](\textcolor{keyword}{auto}\& ref)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00438}00438         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00439}00439             const auto\&  link\_lanelet\_id = find\_link\_lanelet\_id\_by\_enter\_depart\_lanelet\_ids(ref.enter\_lanelet\_id, ref.depart\_lanelet\_id);    }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00440}00440             if(link\_lanelet\_id != lanelet::InvalId)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00441}00441             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00442}00442                 ref.link\_lanelet\_id = link\_lanelet\_id;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00443}00443                 link\_lanelet2signal\_group\_id\_m.insert(\{link\_lanelet\_id, ref.signal\_group\_id\});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00444}00444             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00445}00445         \});     }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00446}00446 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00447}00447         \textcolor{comment}{//Update intersection link lanelet info with signal group id}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00448}00448         \textcolor{keywordtype}{bool} is\_signal\_group\_updated = \textcolor{keyword}{false};   }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00449}00449         std::for\_each(this-\/>int\_info.link\_lanelets\_info.begin(), this-\/>int\_info.link\_lanelets\_info.end(), [\&](\textcolor{keyword}{auto}\& ref)\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00450}00450             auto find\_itr = link\_lanelet2signal\_group\_id\_m.find(ref.id);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00451}00451             if(find\_itr != link\_lanelet2signal\_group\_id\_m.end())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00452}00452             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00453}00453                 ref.signal\_group\_id = link\_lanelet2signal\_group\_id\_m[ref.id];}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00454}00454                 is\_signal\_group\_updated = true; }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00455}00455             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00456}00456         \}); }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00457}00457         is\_signal\_group\_updated ? SPDLOG\_INFO(\textcolor{stringliteral}{"{}Intersection info is updated with signal group ids."{}}) : SPDLOG\_INFO(\textcolor{stringliteral}{"{}Intersection\_map message is processed, but intersection information  signal group ids are not updated."{}});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00458}00458         is\_updated = is\_updated || is\_signal\_group\_updated; }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00459}00459         \textcolor{keywordflow}{return} is\_updated;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00460}00460     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00461}00461 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00462}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a41573ac5b4ab6f0c1a6533f52e558056}{00462}}     lanelet::Id intersection\_model::find\_link\_lanelet\_id\_by\_enter\_depart\_lanelet\_ids(\textcolor{keyword}{const} lanelet::Id enter\_lanelet\_id, \textcolor{keyword}{const} lanelet::Id depart\_lanelet\_id )\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00463}00463 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00464}00464         \textcolor{keyword}{const} \textcolor{keyword}{auto}\&  following\_enter\_lanelets = this-\/>vehicleGraph\_ptr-\/>following(get\_enter\_lanelet\_by\_id(enter\_lanelet\_id), \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00465}00465         \textcolor{keyword}{const} \textcolor{keyword}{auto}\&  prev\_depart\_lanelets =  this-\/>vehicleGraph\_ptr-\/>previous(get\_departure\_lanelet\_by\_id(depart\_lanelet\_id), \textcolor{keyword}{true});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00466}00466         std::vector<lanelet::Id> fel\_ids;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00467}00467         std::vector<lanelet::Id> pdl\_ids;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00468}00468         std::vector<lanelet::Id> link\_lanelet\_id\_intersect\_v;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00469}00469         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\&  temp\_lanelet: following\_enter\_lanelets)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00470}00470         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00471}00471             fel\_ids.push\_back(temp\_lanelet.id());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00472}00472         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00473}00473         std::sort(fel\_ids.begin(), fel\_ids.end());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00475}00475         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\&  temp\_lanelet: prev\_depart\_lanelets)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00476}00476         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00477}00477             pdl\_ids.push\_back(temp\_lanelet.id());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00478}00478         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00479}00479         std::sort(pdl\_ids.begin(), pdl\_ids.end());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00480}00480         std::set\_intersection(fel\_ids.begin(), fel\_ids.end(), pdl\_ids.begin(), pdl\_ids.end(), std::back\_inserter(link\_lanelet\_id\_intersect\_v));}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00481}00481         \textcolor{keywordflow}{if}(!link\_lanelet\_id\_intersect\_v.empty())}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00482}00482         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00483}00483             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Found matching link lanelet id = \{0\} for enter lanelet id = \{1\} and departure lanelet id = \{2\}"{}}, link\_lanelet\_id\_intersect\_v.front(),enter\_lanelet\_id, depart\_lanelet\_id);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00484}00484             \textcolor{keywordflow}{return} link\_lanelet\_id\_intersect\_v.front();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00485}00485         \}  }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00486}00486         SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}NO matching link lanelet for enter lanelet id = \{1\} and departure lanelet id = \{2\}"{}}, link\_lanelet\_id\_intersect\_v.front(),enter\_lanelet\_id, depart\_lanelet\_id);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00487}00487         \textcolor{keywordflow}{return} lanelet::InvalId;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00488}00488     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00489}00489 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00490}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a9f4abd2a92777fdcf9891b2dc91fee6b}{00490}}     \textcolor{keywordtype}{void} intersection\_model::mapping\_lane\_id\_2\_lanelet\_id(\textcolor{keyword}{const} \mbox{\hyperlink{structintersection__model_1_1map__referencepoint}{map\_referencepoint}}\& ref\_point, \textcolor{keyword}{const} \mbox{\hyperlink{structintersection__model_1_1map__lane}{map\_lane}}\& lane, \textcolor{keyword}{const} \textcolor{keywordtype}{long} lane\_width, \textcolor{keyword}{const} std::vector<lanelet::ConstLanelet>\& subj\_lanelets, std::unordered\_map<long , lanelet::ConstLanelet>\& lane2lanelet\_m)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00491}00491 \textcolor{keyword}{    }\{    }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00492}00492         std::vector<lanelet::BasicPoint3d> basic\_points = convert\_lane\_path\_2\_basic\_points(ref\_point, lane);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00493}00493         std::unordered\_map<lanelet::Id, double> lanelet2lane\_path\_distance\_m;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00494}00494         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\&  subj\_l: subj\_lanelets)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00495}00495         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00496}00496             \textcolor{keywordtype}{double} avg\_distance = compute\_points\_2\_lanelet\_avg\_distance(basic\_points, subj\_l);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00497}00497             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Lanelet id \{0\} to lane id = \{1\} path points average distance \{2\}"{}}, subj\_l.id(), lane.\mbox{\hyperlink{structintersection__model_1_1map__lane_a388905939c55bdd78886367554a05e2d}{lane\_id}}, avg\_distance);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00498}00498             lanelet2lane\_path\_distance\_m.insert(\{subj\_l.id(), avg\_distance\});   }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00499}00499         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00500}00500         \textcolor{comment}{//Find the nearest lanelet from the lane path by shortest average distance}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00501}00501         \textcolor{keyword}{const} \textcolor{keyword}{auto}\&  min\_distance\_pair = std::min\_element(lanelet2lane\_path\_distance\_m.begin(), lanelet2lane\_path\_distance\_m.end(), [](\textcolor{keyword}{const} \textcolor{keyword}{auto}\& l, \textcolor{keyword}{const} \textcolor{keyword}{auto}\& r)\{return l.second < r.second; \});}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00502}00502         }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00503}00503         \textcolor{keywordtype}{double} max\_lane\_width = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(lane\_width) * CM\_TO\_M;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00504}00504         \textcolor{comment}{//Check whether the average distance between points and lanelet is larger than the lane with (defined from MAP message) itself. }}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00505}00505         \textcolor{keywordflow}{if}(min\_distance\_pair-\/>second < max\_lane\_width)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00506}00506         \{   }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00507}00507             \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& subj\_l: subj\_lanelets)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00508}00508             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00509}00509                 \textcolor{keywordflow}{if}(subj\_l.id() == min\_distance\_pair-\/>first)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00510}00510                 \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00511}00511                     lane2lanelet\_m.insert(\{lane.\mbox{\hyperlink{structintersection__model_1_1map__lane_a388905939c55bdd78886367554a05e2d}{lane\_id}}, subj\_l\});     }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00512}00512                     SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}min\_distance\_pair lanelet id = \{0\}, distance = \{1\}"{}}, min\_distance\_pair-\/>first, min\_distance\_pair-\/>second);   }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00513}00513                 \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00514}00514             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00515}00515         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00516}00516             SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Mapping failure: min\_distance\_pair distance = \{0\} is greater than lane width = \{1\} defined in the MAP message."{}}, min\_distance\_pair-\/>second, max\_lane\_width);   }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00517}00517         \}        }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00518}00518     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00519}00519 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00520}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a9dcde064181b3547cf611adf4af8a9da}{00520}}     std::vector<lanelet::BasicPoint3d> intersection\_model::convert\_lane\_path\_2\_basic\_points(\textcolor{keyword}{const} \mbox{\hyperlink{structintersection__model_1_1map__referencepoint}{map\_referencepoint}}\& ref\_point, \textcolor{keyword}{const} \mbox{\hyperlink{structintersection__model_1_1map__lane}{map\_lane}}\& lane)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00521}00521 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00522}00522         std::vector<lanelet::BasicPoint3d> basic\_point\_v;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00523}00523         \textcolor{keywordtype}{double} lat = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(ref\_point.\mbox{\hyperlink{structintersection__model_1_1map__referencepoint_ab8a02f1563f5fa2f4661f0010b4d56cb}{latitude}}) * TENTH\_TO\_ONE * MICRO\_DEGREE\_TO\_DEGREE;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00524}00524         \textcolor{keywordtype}{double} lon = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(ref\_point.\mbox{\hyperlink{structintersection__model_1_1map__referencepoint_a69698a85463a50f3775e5ac652258e9d}{longitude}}) * TENTH\_TO\_ONE * MICRO\_DEGREE\_TO\_DEGREE; }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00525}00525         \textcolor{keywordtype}{double} elev = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(ref\_point.\mbox{\hyperlink{structintersection__model_1_1map__referencepoint_aa889188b7f990edcf3831b3f45595c65}{elevation}}) * DM\_TO\_M; }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00526}00526         \textcolor{comment}{//ref\_point3d is a the reference point from which subsequent data points are offset}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00527}00527         \textcolor{keyword}{const} \textcolor{keyword}{auto}\&  ref\_point3d = gps\_2\_map\_point(lat, lon, elev);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00528}00528         \textcolor{keywordtype}{double} cur\_x = ref\_point3d.x();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00529}00529         \textcolor{keywordtype}{double} cur\_y = ref\_point3d.y();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00530}00530         \textcolor{keywordtype}{double} cur\_z = ref\_point3d.z();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00531}00531         \textcolor{comment}{//The lane nodes are offsets from the prior node}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00532}00532         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\&  node : lane.\mbox{\hyperlink{structintersection__model_1_1map__lane_a1550fb18d5de5553a0ac7645c88c668c}{nodes}})}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00533}00533         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00534}00534             cur\_x += \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(node.x) * CM\_TO\_M;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00535}00535             cur\_y += \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(node.y) * CM\_TO\_M;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00536}00536 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00537}00537             lanelet::BasicPoint3d basic\_point;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00538}00538             basic\_point.x() = cur\_x;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00539}00539             basic\_point.y() = cur\_y;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00540}00540             basic\_point.z() = cur\_z;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00541}00541             basic\_point\_v.push\_back(basic\_point);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00542}00542         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00543}00543         \textcolor{keywordflow}{return} basic\_point\_v;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00544}00544     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00545}00545 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00546}\mbox{\hyperlink{classintersection__model_1_1intersection__model_ab9dcb476a9265db49cfdc49fc7c51590}{00546}}     \textcolor{keywordtype}{double} intersection\_model::compute\_points\_2\_lanelet\_avg\_distance(\textcolor{keyword}{const} std::vector<lanelet::BasicPoint3d>\&  basic\_points, lanelet::ConstLanelet subj\_lanelet)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00547}00547 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00548}00548         \textcolor{keyword}{auto} points\_num = basic\_points.size();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00549}00549         \textcolor{keywordtype}{double} distance\_sum = 0;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00550}00550         lanelet::ConstLineString2d centerline = subj\_lanelet.centerline2d();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00551}00551         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\&  bp3D: basic\_points)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00552}00552         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00553}00553             \textcolor{keyword}{const} \textcolor{keyword}{auto}\&  bp2d = lanelet::utils::to2D(bp3D);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00554}00554             \textcolor{keywordtype}{double} distance = lanelet::geometry::distance2d(bp2d, centerline);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00555}00555             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Point to lanelet id \{0\} 2D distance \{1\}"{}}, subj\_lanelet.id(), distance);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00556}00556             distance\_sum += distance;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00557}00557         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00558}00558         \textcolor{keywordtype}{double} distance\_avg = distance\_sum/\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(points\_num);}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00559}00559         \textcolor{keywordflow}{return} distance\_avg;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00560}00560     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00561}00561 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00562}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a7967e15bbce9062a48c43f82b6d89124}{00562}}     lanelet::BasicPoint3d intersection\_model::gps\_2\_map\_point(\textcolor{keywordtype}{double} lat, \textcolor{keywordtype}{double} lon, \textcolor{keywordtype}{double} elev )\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00563}00563 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00564}00564         lanelet::GPSPoint sub\_gps;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00565}00565         sub\_gps.ele = elev;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00566}00566         sub\_gps.lat = lat;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00567}00567         sub\_gps.lon = lon;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00568}00568         lanelet::BasicPoint3d basic\_point;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00569}00569         \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00570}00570         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00571}00571             basic\_point =  projector-\/>forward(sub\_gps); }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00572}00572         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00573}00573         \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} lanelet::ForwardProjectionError \&ex)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00574}00574         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00575}00575             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Cannot project the GPS position: Latitude: \{0\} , Longitude: \{1\}, Elevation: \{2\}. Error details: \{3\}"{}}, lat, lon, elev, ex.what());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00576}00576         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00577}00577         \textcolor{keywordflow}{return} basic\_point;    }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00578}00578     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00579}00579 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00580}\mbox{\hyperlink{classintersection__model_1_1intersection__model_ad26188c4208541965a452bb4a920c113}{00580}}     lanelet::GPSPoint intersection\_model::map\_point2\_gps(\textcolor{keywordtype}{double} x, \textcolor{keywordtype}{double} y, \textcolor{keywordtype}{double} z)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00581}00581 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00582}00582         lanelet::BasicPoint3d sub\_map\_point;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00583}00583         sub\_map\_point.x() = x;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00584}00584         sub\_map\_point.y() = y;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00585}00585         sub\_map\_point.z() = z;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00586}00586         lanelet::GPSPoint gps\_point;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00587}00587         \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00588}00588         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00589}00589             gps\_point =  projector-\/>reverse(sub\_map\_point); }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00590}00590         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00591}00591         \textcolor{keywordflow}{catch} (\textcolor{keyword}{const} lanelet::ReverseProjectionError \&ex)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00592}00592         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00593}00593             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Cannot project (x, y,z) point to geolocation: (\{0\} ,\{1\}, \{2\}). Error \{3\}"{}}, x, y, z, ex.what());}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00594}00594         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00595}00595         \textcolor{keywordflow}{return} gps\_point;  }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00596}00596     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00597}00597 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00598}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a7ff3964a9bf2d85e2223d066cf405bc7}{00598}}     lanelet::ConstLanelet intersection\_model::get\_enter\_lanelet\_by\_id(lanelet::Id \textcolor{keywordtype}{id})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00599}00599 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00600}00600         lanelet::ConstLanelet result;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00601}00601         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\&  ll : this-\/>entering\_lanelets)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00602}00602         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00603}00603             \textcolor{keywordflow}{if}(ll.id() == \textcolor{keywordtype}{id})}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00604}00604             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00605}00605                 \textcolor{keywordflow}{return} ll;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00606}00606             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00607}00607         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00608}00608         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00609}00609     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00610}00610 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00611}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a8bee9ae6e1a3a1c6be299005bda953e0}{00611}}     lanelet::ConstLanelet intersection\_model::get\_link\_lanelet\_by\_id(lanelet::Id \textcolor{keywordtype}{id})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00612}00612 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00613}00613         lanelet::ConstLanelet result;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00614}00614         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\&  ll : this-\/>link\_lanelets)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00615}00615         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00616}00616             \textcolor{keywordflow}{if}(ll.id() == \textcolor{keywordtype}{id})}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00617}00617             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00618}00618                 \textcolor{keywordflow}{return} ll;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00619}00619             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00620}00620         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00621}00621         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00622}00622     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00623}00623 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00624}\mbox{\hyperlink{classintersection__model_1_1intersection__model_adf6507902505cd058d3756e1a2f9ef80}{00624}}     lanelet::ConstLanelet intersection\_model::get\_departure\_lanelet\_by\_id(lanelet::Id \textcolor{keywordtype}{id})\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00625}00625 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00626}00626         lanelet::ConstLanelet result;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00627}00627         \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\&  ll : this-\/>departure\_lanelets)}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00628}00628         \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00629}00629             \textcolor{keywordflow}{if}(ll.id() == \textcolor{keywordtype}{id})}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00630}00630             \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00631}00631                 \textcolor{keywordflow}{return} ll;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00632}00632             \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00633}00633         \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00634}00634         \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00635}00635     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00637}\mbox{\hyperlink{classintersection__model_1_1intersection__model_a702859699d08fa112c32d2e1654c4c78}{00637}}     intersection\_model::\string~intersection\_model()}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00638}00638     \{}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00639}00639         int\_info.link\_lanelets\_info.clear();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00640}00640         int\_info.entering\_lanelets\_info.clear();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00641}00641         int\_info.departure\_lanelets\_info.clear();}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00642}00642     \}}
\DoxyCodeLine{\Hypertarget{intersection__model_8cpp_source_l00643}00643 \}}

\end{DoxyCode}
