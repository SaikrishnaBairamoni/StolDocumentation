\hypertarget{spat__worker_8cpp_source}{}\doxysection{spat\+\_\+worker.\+cpp}
\label{spat__worker_8cpp_source}\index{tsc\_client\_service/src/spat\_worker.cpp@{tsc\_client\_service/src/spat\_worker.cpp}}
\mbox{\hyperlink{spat__worker_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{spat__worker_8h}{spat\_worker.h}}"{}}}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00003}00003 \textcolor{keyword}{using namespace }std;}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00005}00005 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacetraffic__signal__controller__service}{traffic\_signal\_controller\_service}}}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00006}00006 \{}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00008}\mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_a3a679b92d5d397cf74684a90ab56dab8}{00008}}     \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_a3a679b92d5d397cf74684a90ab56dab8}{spat\_worker::spat\_worker}}(\textcolor{keyword}{const} std::string\& ip, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& port, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& socket\_timeout, \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_msg\_timestamp ) :}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00009}00009                           socket\_ip\_(ip), socket\_port\_(port), socket\_timeout\_(socket\_timeout), \_use\_msg\_timestamp(use\_msg\_timestamp)}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00010}00010     \{}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00011}00011         SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Creating Spat Worker"{}});}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00012}00012         }
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00013}00013     \}}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00014}\mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_ac79506c9870fa7010c7c4403939a87cb}{00014}}     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_ac79506c9870fa7010c7c4403939a87cb}{spat\_worker::initialize}}() \{}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00015}00015         \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_af4376217cd80cff72b70d38c2d0d55d1}{spat\_listener}} = std::make\_unique<udp\_socket\_listener>( \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_a9a3ae5052adf4ec92ed6a4b0037be944}{socket\_ip\_}}, \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_a6910dda204a67ee0a45324029e209654}{socket\_port\_}}, \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_a63226b291bc20ac8d9334899095a9aba}{socket\_timeout\_}});}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00016}00016         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_af4376217cd80cff72b70d38c2d0d55d1}{spat\_listener}}-\/>initialize()) \{}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00017}00017             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}Failed to initialize udp socket!"{}});}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00018}00018             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00019}00019         \}}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00020}00020         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00021}00021     \}}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00023}\mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_aa38e623a3c2a391069809669672e4014}{00023}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_aa38e623a3c2a391069809669672e4014}{spat\_worker::receive\_spat}}(\textcolor{keyword}{const} shared\_ptr<signal\_phase\_and\_timing::spat> \_spat\_ptr)\textcolor{keyword}{ const}}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00024}00024 \textcolor{keyword}{    }\{}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00025}00025         std::vector<char> spat\_buf = \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_af4376217cd80cff72b70d38c2d0d55d1}{spat\_listener}}-\/>receive();}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00026}00026         \mbox{\hyperlink{structntcip_1_1ntcip__1202__ext}{ntcip::ntcip\_1202\_ext}} ntcip\_1202\_data;}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00027}00027         std::memcpy(\&ntcip\_1202\_data, spat\_buf.data(), spat\_buf.size());}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00028}00028         \_spat\_ptr-\/>update(ntcip\_1202\_data, \mbox{\hyperlink{classtraffic__signal__controller__service_1_1spat__worker_a4ee619a743fa9ddcfea5347f82988630}{\_use\_msg\_timestamp}});}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00030}00030            }
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00031}00031     \}}
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{spat__worker_8cpp_source_l00033}00033 \}}

\end{DoxyCode}
