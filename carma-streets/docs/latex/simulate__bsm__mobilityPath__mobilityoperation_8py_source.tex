\hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source}{}\doxysection{simulate\+\_\+bsm\+\_\+mobility\+Path\+\_\+mobilityoperation.\+py}
\label{simulate__bsm__mobilityPath__mobilityoperation_8py_source}\index{scripts/simulate\_bsm\_mobilityPath\_mobilityoperation.py@{scripts/simulate\_bsm\_mobilityPath\_mobilityoperation.py}}
\mbox{\hyperlink{simulate__bsm__mobilityPath__mobilityoperation_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00001}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation}{00001}} \textcolor{keyword}{from} os \textcolor{keyword}{import} read}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00002}00002 \textcolor{keyword}{from} kafka \textcolor{keyword}{import} KafkaProducer}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00003}00003 \textcolor{keyword}{import} time}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00004}00004 \textcolor{keyword}{from} time \textcolor{keyword}{import} sleep}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00005}00005 \textcolor{keyword}{import} json}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00006}00006 \textcolor{keyword}{import} threading}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00009}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a181207311f08828cd4fec5733ef48435}{00009}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a181207311f08828cd4fec5733ef48435}{read\_json}}(json\_name):}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00010}00010     data = \{\}}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00011}00011     \textcolor{keyword}{with} open(json\_name, \textcolor{stringliteral}{"{}r"{}}) \textcolor{keyword}{as} json\_file:}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00012}00012         data = json.load(json\_file)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00013}00013     \textcolor{keywordflow}{return} data}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00016}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_ae46b84dfc477467b8f77e6fd1abb445b}{00016}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_ae46b84dfc477467b8f77e6fd1abb445b}{produce\_bsm}}():}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00017}00017     producer = KafkaProducer(bootstrap\_servers=[\textcolor{stringliteral}{"{}127.0.0.1:9092"{}}],}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00018}00018                              value\_serializer=\textcolor{keyword}{lambda} x: json.dumps(x).encode(\textcolor{stringliteral}{'utf-\/8'}))}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00019}00019     count = 100}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00020}00020     i = 0}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00021}00021     while(i < count):}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00022}00022         data = \mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a181207311f08828cd4fec5733ef48435}{read\_json}}(\textcolor{stringliteral}{'bsm\_12\_8.json'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00023}00023         data[\textcolor{stringliteral}{"{}core\_data"{}}][\textcolor{stringliteral}{"{}msg\_count"{}}] = str(i)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00024}00024         data[\textcolor{stringliteral}{"{}core\_data"{}}][\textcolor{stringliteral}{"{}speed"{}}] = str(i)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00025}00025         producer.send(\textcolor{stringliteral}{'v2xhub\_bsm\_in'}, value=data)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00026}00026         print(\textcolor{stringliteral}{'Sent a bsm.'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00027}00027         i += 1}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00028}00028         sleep(0.1)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00029}00029         producer.flush()}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00032}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a4735ac1db8f7008b28e56682b2a14a17}{00032}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a4735ac1db8f7008b28e56682b2a14a17}{produce\_operation}}():}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00033}00033     producer = KafkaProducer(bootstrap\_servers=[\textcolor{stringliteral}{"{}127.0.0.1:9092"{}}],}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00034}00034                              value\_serializer=\textcolor{keyword}{lambda} x: json.dumps(x).encode(\textcolor{stringliteral}{'utf-\/8'}))}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00035}00035     count = 100}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00036}00036     i = 0}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00037}00037     while(i < count):}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00038}00038         data = \mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a181207311f08828cd4fec5733ef48435}{read\_json}}(\textcolor{stringliteral}{'mobilityoperation\_12\_8.json'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00039}00039         timestamp = int(time.time())*1000 + i*100}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00040}00040         data[\textcolor{stringliteral}{"{}metadata"{}}][\textcolor{stringliteral}{"{}timestamp"{}}] = str(timestamp)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00041}00041         strategy\_params = \textcolor{stringliteral}{"{}msg\_count:"{}} + \(\backslash\)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00042}00042             str(i) + \textcolor{stringliteral}{"{},access: 0,max\_accel:1.500000,max\_decel: -\/1.000000,react\_time: 4.500000, min\_gap: 5.000000, depart\_pos: "{}} \(\backslash\)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00043}00043             + str(i) + \textcolor{stringliteral}{"{},turn\_direction:straight, sec\_mark:37056"{}}}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00044}00044         data[\textcolor{stringliteral}{"{}strategy\_params"{}}] = strategy\_params}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00045}00045         producer.send(\textcolor{stringliteral}{'v2xhub\_mobility\_operation\_in'}, value=data)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00046}00046         print(\textcolor{stringliteral}{'Sent a mobilityoperation.'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00047}00047         i += 1}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00048}00048         sleep(0.1)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00049}00049         producer.flush()}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00050}00050 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00052}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a85c6ab76874d8fc3462be4b7a5d7893c}{00052}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a85c6ab76874d8fc3462be4b7a5d7893c}{produce\_mobility\_path}}():}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00053}00053     producer = KafkaProducer(bootstrap\_servers=[\textcolor{stringliteral}{"{}127.0.0.1:9092"{}}],}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00054}00054                              value\_serializer=\textcolor{keyword}{lambda} x: json.dumps(x).encode(\textcolor{stringliteral}{'utf-\/8'}))}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00055}00055     i = 0}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00056}00056     count = 100}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00057}00057     while(i < count):}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00058}00058         data = \mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a181207311f08828cd4fec5733ef48435}{read\_json}}(\textcolor{stringliteral}{'mobilitypath\_12\_8.json'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00059}00059         timestamp = int(time.time())*1000 + i*100}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00060}00060         data[\textcolor{stringliteral}{"{}metadata"{}}][\textcolor{stringliteral}{"{}timestamp"{}}] = str(timestamp)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00061}00061         producer.send(\textcolor{stringliteral}{'v2xhub\_mobility\_path\_in'}, value=data)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00062}00062         print(\textcolor{stringliteral}{'Sent a mobilitypath.'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00063}00063         i += 1}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00064}00064         sleep(0.1)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00065}00065         producer.flush()}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00066}00066 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00068}00068 \textcolor{keywordflow}{if} \_\_name\_\_ == \textcolor{stringliteral}{"{}\_\_main\_\_"{}}:}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00069}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a01ce012224c75a31e9efeb106395a031}{00069}}     bsm\_th = threading.Thread(target=produce\_bsm)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00070}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_afc26138a5b4ec3d97c5f38c082ff41dc}{00070}}     mobility\_path\_th = threading.Thread(target=produce\_mobility\_path)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00071}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath__mobilityoperation_a9ab26a9c67d2b0141fe16cd492b41c23}{00071}}     mobility\_operation\_th = threading.Thread(target=produce\_operation)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00072}00072     mobility\_path\_th.start()}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00073}00073     bsm\_th.start()}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath__mobilityoperation_8py_source_l00074}00074     mobility\_operation\_th.start()}

\end{DoxyCode}
