\hypertarget{signalized__vehicle__scheduler_8cpp_source}{}\doxysection{signalized\+\_\+vehicle\+\_\+scheduler.\+cpp}
\label{signalized__vehicle__scheduler_8cpp_source}\index{streets\_utils/streets\_vehicle\_scheduler/src/signalized\_vehicle\_scheduler.cpp@{streets\_utils/streets\_vehicle\_scheduler/src/signalized\_vehicle\_scheduler.cpp}}
\mbox{\hyperlink{signalized__vehicle__scheduler_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00001}00001 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{signalized__vehicle__scheduler_8h}{signalized\_vehicle\_scheduler.h}}"{}}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00003}00003 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacestreets__vehicle__scheduler}{streets\_vehicle\_scheduler}} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00005}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a2572fdbb86e141df40174d618fe2a3d0}{00005}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a2572fdbb86e141df40174d618fe2a3d0}{signalized\_vehicle\_scheduler::schedule\_vehicles}}( std::unordered\_map<std::string, streets\_vehicles::vehicle> \&vehicles, std::shared\_ptr<intersection\_schedule> \&i\_sched) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00006}00006         }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00007}00007         \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00008}00008             \textcolor{keyword}{auto} schedule = std::dynamic\_pointer\_cast<signalized\_intersection\_schedule> (i\_sched);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00009}00009             }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00010}00010             \textcolor{keywordflow}{if} ( vehicles.empty() ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00011}00011                 SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}No vehicles to schedule."{}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00012}00012                 \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00013}00013             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00015}00015             \textcolor{comment}{// Estimate Vehicles at common time }}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00016}00016             \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1vehicle__scheduler_a85947f43b293504a108619374c0c0dae}{estimate\_vehicles\_at\_common\_time}}( vehicles, schedule-\/>timestamp);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00017}00017             \textcolor{comment}{// Create vectors of DVs and EVs}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00018}00018             std::list<streets\_vehicles::vehicle> DVs;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00019}00019             std::list<streets\_vehicles::vehicle> EVs;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00020}00020             }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00021}00021             \textcolor{keywordflow}{for} ( \textcolor{keyword}{const} \textcolor{keyword}{auto} \&[v\_id, veh] : vehicles) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00022}00022                 \textcolor{keywordflow}{if} ( veh.\_cur\_state == \mbox{\hyperlink{namespacestreets__vehicles_a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de}{streets\_vehicles::vehicle\_state::EV}}) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00023}00023                     EVs.push\_back(veh);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00024}00024                 \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00025}00025                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( veh.\_cur\_state == \mbox{\hyperlink{namespacestreets__vehicles_a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00}{streets\_vehicles::vehicle\_state::DV}} ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00026}00026                     DVs.push\_back(veh);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00027}00027                 \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00028}00028             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00029}00029             }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00030}00030             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Number of Entering Vehicles (EVs) to schedule are : \{0\} "{}}, EVs.size());}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00031}00031 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00032}00032             \textcolor{comment}{// Schedule DVs}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00033}00033             \textcolor{keywordflow}{if} ( !DVs.empty() )}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00034}00034                 \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a4ff15023fb9c14d1765ebe78d3d3a944}{schedule\_dvs}}( DVs, schedule);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00035}00035             \textcolor{comment}{// Schedule EVs}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00036}00036             \textcolor{keywordflow}{if} ( !EVs.empty() )}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00037}00037                 \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_ac41bc42db46cbbf7a037486fa46dd7e0}{schedule\_evs}}( EVs, schedule);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00038}00038         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00039}00039         \textcolor{keywordflow}{catch} ( \textcolor{keyword}{const} \mbox{\hyperlink{classstreets__service_1_1streets__configuration__exception}{streets\_service::streets\_configuration\_exception}} \&ex ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00040}00040             SPDLOG\_ERROR(\textcolor{stringliteral}{"{}signalized scheduler failure: \{0\} "{}}, ex.what());}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00041}00041         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00043}00043     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00046}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a4ff15023fb9c14d1765ebe78d3d3a944}{00046}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a4ff15023fb9c14d1765ebe78d3d3a944}{signalized\_vehicle\_scheduler::schedule\_dvs}}( \textcolor{keyword}{const} std::list<streets\_vehicles::vehicle> \&dvs, \textcolor{keyword}{const} std::shared\_ptr<signalized\_intersection\_schedule> \&schedule )\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00047}00047         }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00048}00048         \textcolor{keywordflow}{for} ( \textcolor{keyword}{const} \textcolor{keyword}{auto} \&departing\_veh : dvs ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00049}00049             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Scheduling the departure time for DV with ID \{0\} ."{}}, departing\_veh.\_id);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00050}00050             \textcolor{comment}{// get link lane info}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00051}00051             \mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info}{OpenAPI::OAILanelet\_info}} lane\_info =  \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c}{get\_link\_lanelet\_info}}( departing\_veh );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00052}00052             \textcolor{comment}{// calculate clearance time in milliseconds }}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00053}00053             uint64\_t clearance\_time = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a1cce3f6e4da6ae1804dfd6a49305baf2}{estimate\_clearance\_time}}( departing\_veh );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00055}00055             \mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule}{signalized\_vehicle\_schedule}} veh\_sched;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00056}00056             \textcolor{comment}{// set id}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00057}00057             veh\_sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1vehicle__schedule_ad9c43fcd19029d3f8ddc56486a0a2cf1}{v\_id}} = departing\_veh.\_id;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00058}00058             \textcolor{comment}{// set et }}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00059}00059             veh\_sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_a508a6d75fcf630309aa378c4fbeb3171}{et}} = departing\_veh.\_actual\_et;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00060}00060             \textcolor{comment}{// departure time is equal to current time plus clearance time for DVs}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00061}00061             veh\_sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_a4e258c3309f6d86f85f5fb36e801ee5d}{dt}} =  schedule-\/>timestamp + clearance\_time;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00062}00062             \textcolor{comment}{// set state}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00063}00063             veh\_sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_afdb3b1e43d8f12071f3e4b6b5780ef99}{state}} = departing\_veh.\_cur\_state;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00064}00064             \textcolor{comment}{// set vehicle link id}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00065}00065             veh\_sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1vehicle__schedule_a7329784dde8da0782afa24ae9473a12d}{link\_id}} =  departing\_veh.\_link\_id;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00066}00066             \textcolor{comment}{// set vehicle entry lane id}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00067}00067             veh\_sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1vehicle__schedule_a84fbf12e6e10638b71247bb9435aa3a5}{entry\_lane}} =  departing\_veh.\_entry\_lane\_id;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00069}00069             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Added schedule for DV \{0\} with dt \{1\}."{}}, veh\_sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1vehicle__schedule_ad9c43fcd19029d3f8ddc56486a0a2cf1}{v\_id}}, veh\_sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_a4e258c3309f6d86f85f5fb36e801ee5d}{dt}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00070}00070             \textcolor{comment}{// add vehicle\_schedule}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00071}00071             schedule-\/>vehicle\_schedules.push\_back(veh\_sched);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00072}00072         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00074}00074     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00078}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_ac41bc42db46cbbf7a037486fa46dd7e0}{00078}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_ac41bc42db46cbbf7a037486fa46dd7e0}{signalized\_vehicle\_scheduler::schedule\_evs}}( std::list<streets\_vehicles::vehicle> \&evs, \textcolor{keyword}{const} std::shared\_ptr<signalized\_intersection\_schedule> \&schedule )\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00079}00079         }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00080}00080         \textcolor{comment}{// Sort vehicles based on distance}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00081}00081         evs.sort(\mbox{\hyperlink{namespacestreets__vehicle__scheduler_ab550673e6a269f9f374ca3ca7ff6ba82}{distance\_comparator}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00082}00082         }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00083}00083         \textcolor{comment}{// Create a map of entry lane id keys and list of EVs in each lane.}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00084}00084         std::unordered\_map<int, std::list<streets\_vehicles::vehicle>> vehicle\_lane\_map;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00085}00085         \textcolor{keywordflow}{for} ( \textcolor{keyword}{const} \textcolor{keyword}{auto} \&entry\_lane : \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1vehicle__scheduler_a5fa37276e5ccb41e38cbef573e830e8e}{intersection\_info}}-\/>getEntryLanelets() ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00086}00086             std::list<streets\_vehicles::vehicle> vehicles\_in\_lane;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00087}00087             \textcolor{keywordflow}{for} ( \textcolor{keyword}{const} \textcolor{keyword}{auto} \&ev : evs ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00088}00088                 \textcolor{keywordflow}{if} ( ev.\_entry\_lane\_id == entry\_lane.getId()) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00089}00089                     SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Adding vehicle \{0\} to EVs list in entry lane \{1\}"{}}, ev.\_id, ev.\_entry\_lane\_id);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00090}00090                     vehicles\_in\_lane.push\_back(ev);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00091}00091                 \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00092}00092             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00093}00093             \textcolor{keywordflow}{if} ( !vehicles\_in\_lane.empty()) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00094}00094                 vehicles\_in\_lane.sort(\mbox{\hyperlink{namespacestreets__vehicle__scheduler_ab550673e6a269f9f374ca3ca7ff6ba82}{distance\_comparator}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00095}00095                 vehicle\_lane\_map.try\_emplace( entry\_lane.getId(), vehicles\_in\_lane );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00096}00096             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00097}00097             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00098}00098                 SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}No EVs in lane \{0\}."{}}, \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(entry\_lane.getId()) );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00099}00099             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00100}00100         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00101}00101         \textcolor{keywordflow}{if} ( vehicle\_lane\_map.empty() ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00102}00102             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1scheduling__exception}{scheduling\_exception}}(\textcolor{stringliteral}{"{}Map of vehicles to be scheduled is empty but list of EVs to be scheduled is not!"{}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00103}00103         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00104}00104         }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00105}00105         \textcolor{keywordflow}{for} ( \textcolor{keyword}{const} \textcolor{keyword}{auto} \&[entry\_lane, evs\_in\_lane] : vehicle\_lane\_map ) \{           }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00106}00106             }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00107}00107             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Scheduling EVs from entry lane \{0\} "{}}, entry\_lane);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00109}00109             \textcolor{comment}{// Find the last DV from the entry lane}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00110}00110             std::shared\_ptr<signalized\_vehicle\_schedule> preceding\_veh = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00111}00111             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&veh\_sched : schedule-\/>vehicle\_schedules ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00112}00112                 \textcolor{keywordflow}{if} ( veh\_sched.entry\_lane == entry\_lane \&\& veh\_sched.state == \mbox{\hyperlink{namespacestreets__vehicles_a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00}{streets\_vehicles::vehicle\_state::DV}} \&\& (preceding\_veh == \textcolor{keyword}{nullptr} || veh\_sched.et < preceding\_veh-\/>et)) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00113}00113                     preceding\_veh = std::make\_shared<signalized\_vehicle\_schedule>(veh\_sched);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00114}00114                 \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00115}00115             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00116}00116             }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00117}00117             \textcolor{comment}{// Find the entry lane object}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00118}00118             \mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info}{OpenAPI::OAILanelet\_info}} entry\_lane\_info;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00119}00119             \textcolor{keywordflow}{for} ( \textcolor{keyword}{const} \textcolor{keyword}{auto} \&lane : \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1vehicle__scheduler_a5fa37276e5ccb41e38cbef573e830e8e}{intersection\_info}}-\/>getEntryLanelets() )\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00120}00120                 \textcolor{keywordflow}{if} ( lane.getId() == entry\_lane ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00121}00121                     entry\_lane\_info = lane;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00122}00122                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00123}00123                 \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00124}00124             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00125}00125             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}The signal group id of the entry lane \{0\} = \{1\}"{}}, entry\_lane\_info.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a489d1a475686159298697bccabd2bd52}{getId}}(), entry\_lane\_info.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a71c6691fa0f9af797b4540f8a94ad9be}{getSignalGroupId}}());}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00127}00127             \textcolor{comment}{// Get the movement\_state object that connects to this entry lane}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00128}00128             \mbox{\hyperlink{structsignal__phase__and__timing_1_1movement__state}{signal\_phase\_and\_timing::movement\_state}} move\_state = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aed159065f9086c0c9e8b7c7476f3e7aa}{find\_movement\_state\_for\_lane}}(entry\_lane\_info);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00130}00130             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&ev : evs\_in\_lane)\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00131}00131                 \mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule}{signalized\_vehicle\_schedule}} sched;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00132}00132                 SPDLOG\_DEBUG( \textcolor{stringliteral}{"{}Estimating schedule for \{0\}."{}}, ev.\_id);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00133}00133                 \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a4d00a1ab964b44569653d414280a3419}{estimate\_et}}(ev, preceding\_veh, sched, move\_state, schedule-\/>timestamp);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00134}00134                 \textcolor{comment}{// Add vehicle schedule to the schedule list.}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00135}00135                 schedule-\/>vehicle\_schedules.push\_back(sched);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00136}00136                 \textcolor{comment}{// Update the preceding vehicle schedule.}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00137}00137                 preceding\_veh = std::make\_shared<signalized\_vehicle\_schedule>(sched);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00138}00138             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00140}00140             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}All vehicles in lane \{0\} have been scheduled!"{}}, entry\_lane);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00141}00141 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00142}00142         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00143}00143     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00146}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aed159065f9086c0c9e8b7c7476f3e7aa}{00146}}     \mbox{\hyperlink{structsignal__phase__and__timing_1_1movement__state}{signal\_phase\_and\_timing::movement\_state}} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aed159065f9086c0c9e8b7c7476f3e7aa}{signalized\_vehicle\_scheduler::find\_movement\_state\_for\_lane}}(\textcolor{keyword}{const} \mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info}{OpenAPI::OAILanelet\_info}} \&entry\_lane\_info)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00147}00147 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00148}00148         \mbox{\hyperlink{structsignal__phase__and__timing_1_1movement__state}{signal\_phase\_and\_timing::movement\_state}} move\_state; }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00149}00149         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aa17cd405d5cda86d877060b915b9aa32}{spat\_ptr}} || entry\_lane\_info.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a71c6691fa0f9af797b4540f8a94ad9be}{getSignalGroupId}}() ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00150}00150             \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto}\& ms : \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aa17cd405d5cda86d877060b915b9aa32}{spat\_ptr}}-\/>intersections.front().states)\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00151}00151                 \textcolor{keywordflow}{if} (ms.signal\_group == entry\_lane\_info.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a71c6691fa0f9af797b4540f8a94ad9be}{getSignalGroupId}}()) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00152}00152                     move\_state = ms;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00153}00153                     \textcolor{keywordflow}{return} move\_state;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00154}00154                 \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00155}00155             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00156}00156         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00157}00157         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00158}00158             \textcolor{keywordflow}{if} ( \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aa17cd405d5cda86d877060b915b9aa32}{spat\_ptr}} ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00159}00159                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1scheduling__exception}{scheduling\_exception}}(\textcolor{stringliteral}{"{}SPaT is not found!"{}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00160}00160             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00161}00161             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00162}00162                 \textcolor{keywordflow}{throw} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1scheduling__exception}{scheduling\_exception}}(\textcolor{stringliteral}{"{}the lanelet does not have group\_id!"{}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00163}00163             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00164}00164         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00165}00165         \textcolor{keywordflow}{return} move\_state;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00166}00166     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00167}00167 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00169}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a4d00a1ab964b44569653d414280a3419}{00169}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a4d00a1ab964b44569653d414280a3419}{signalized\_vehicle\_scheduler::estimate\_et}}(\textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh, \textcolor{keyword}{const} std::shared\_ptr<signalized\_vehicle\_schedule> \&preceding\_veh, \mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule}{signalized\_vehicle\_schedule}} \&sched, \textcolor{keyword}{const} \mbox{\hyperlink{structsignal__phase__and__timing_1_1movement__state}{signal\_phase\_and\_timing::movement\_state}} \&move\_state, \textcolor{keyword}{const} uint64\_t schedule\_timestamp)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00170}00170 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00171}00171         \textcolor{comment}{// Get link lanelet information for ev}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00172}00172         \mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info}{OpenAPI::OAILanelet\_info}} link\_lane = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c}{get\_link\_lanelet\_info}}( veh );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00173}00173         SPDLOG\_DEBUG( \textcolor{stringliteral}{"{}Link lanelet for vehicle \{0\} is \{1\}."{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}}, link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a489d1a475686159298697bccabd2bd52}{getId}}());}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00174}00174         \textcolor{comment}{// Calculate EET for vehicle}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00175}00175         uint64\_t eet = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a616f990b94f85cbe7c8ac5ecc215d41c}{calculate\_earliest\_entering\_time}}(veh);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00176}00176         SPDLOG\_DEBUG( \textcolor{stringliteral}{"{}EET for vehicle \{0\} is \{1\}."{}} ,veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}}, eet );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00177}00177         \textcolor{comment}{// Calculate min\_headway}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00178}00178         uint64\_t min\_headway = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a6b1ad1b03c5a472d08448ddaaae63369}{calculate\_min\_headway}}( veh, link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}() );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00179}00179         SPDLOG\_DEBUG( \textcolor{stringliteral}{"{}min headway for vehicle \{0\} is \{1\}."{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}}, min\_headway );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00183}00183         uint64\_t first\_available\_et;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00184}00184         \textcolor{keywordflow}{if} (preceding\_veh == \textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00185}00185             first\_available\_et = schedule\_timestamp;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00186}00186         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00187}00187         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00188}00188             first\_available\_et = std::max(schedule\_timestamp, preceding\_veh-\/>et + min\_headway);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00189}00189         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00190}00190 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00191}00191         \textcolor{comment}{// Check the movement\_event list one by one until successfully estimating the vehicle's entering time (ET).}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00192}00192         \textcolor{comment}{// The assumption is that the movement\_event list is sorted based on the movement\_event timing.}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00193}00193         \textcolor{comment}{// (example: the second phase's start time shall be equal to the first phase's min\_end\_time).}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00194}00194         \textcolor{keywordtype}{bool} is\_successful = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00195}00195         uint64\_t et;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00196}00196         \textcolor{keywordflow}{for} (\textcolor{keyword}{const} \textcolor{keyword}{auto} \&move\_event : move\_state.\mbox{\hyperlink{structsignal__phase__and__timing_1_1movement__state_a087beaba691971b31df26e90bf4e81c4}{state\_time\_speed}}) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00197}00197             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Moving to the next movement event from the list! start time without buffer = \{0\}, end time without buffer = \{1\}"{}}, move\_event.timing.get\_epoch\_start\_time(), move\_event.timing.get\_epoch\_min\_end\_time() );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00198}00198             \textcolor{keywordflow}{if} (move\_event.event\_state == \mbox{\hyperlink{namespacesignal__phase__and__timing_a89bd5b280352669f719b2c36a9dc2a14ababa6a65d4933ea6229e61b20668218b}{signal\_phase\_and\_timing::movement\_phase\_state::protected\_movement\_allowed}}) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00199}00199                 et = std::max(first\_available\_et, std::max(eet, move\_event.timing.get\_epoch\_start\_time() + \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aed5f596d0160b7fc2941f8f003293f50}{initial\_green\_buffer}}));}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00200}00200                 \textcolor{keywordflow}{if} ( et < move\_event.timing.get\_epoch\_min\_end\_time() -\/ \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_af23ea3f8079aedda1f3e36203d0bc0c9}{final\_green\_buffer}} ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00201}00201                     SPDLOG\_DEBUG( \textcolor{stringliteral}{"{}Successfully estimate an ET (within a green phase) for vehicle \{0\}. The estimated ET = \{1\}."{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}}, et);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00202}00202                     is\_successful = \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00203}00203                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00204}00204                 \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00205}00205                 SPDLOG\_DEBUG( \textcolor{stringliteral}{"{}The estimated ET for vehicle \{0\} is later than the end of the phase. Estimated ET = \{1\}, end of the phase"{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}}, et, move\_event.timing.get\_epoch\_min\_end\_time() -\/ \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_af23ea3f8079aedda1f3e36203d0bc0c9}{final\_green\_buffer}} );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00206}00206             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00207}00207         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00208}00208 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00209}00209         \textcolor{comment}{// TBD area}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00210}00210         \textcolor{keywordflow}{if} (!is\_successful) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00211}00211             et = std::max(first\_available\_et, std::max(eet, move\_state.\mbox{\hyperlink{structsignal__phase__and__timing_1_1movement__state_a087beaba691971b31df26e90bf4e81c4}{state\_time\_speed}}.back().timing.get\_epoch\_min\_end\_time() + \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aed5f596d0160b7fc2941f8f003293f50}{initial\_green\_buffer}}));}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00212}00212             SPDLOG\_DEBUG( \textcolor{stringliteral}{"{}Successfully estimate an ET (within TBD area) for vehicle \{0\}. The estimated ET = \{1\}."{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}}, et);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00213}00213         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00214}00214 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00215}00215         \textcolor{comment}{// Set schedule properties}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00216}00216         sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1vehicle__schedule_ad9c43fcd19029d3f8ddc56486a0a2cf1}{v\_id}} =  veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00217}00217         sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_afa9ea3f6d6edea565e80cd279f69df0b}{eet}} = eet;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00218}00218         sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_a508a6d75fcf630309aa378c4fbeb3171}{et}} = et;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00219}00219         sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_a4e258c3309f6d86f85f5fb36e801ee5d}{dt}} = sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_a508a6d75fcf630309aa378c4fbeb3171}{et}} + \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a1cce3f6e4da6ae1804dfd6a49305baf2}{estimate\_clearance\_time}}( veh );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00220}00220         sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1vehicle__schedule_a84fbf12e6e10638b71247bb9435aa3a5}{entry\_lane}} =  veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a4ef0e2e811b0f5cb00f14b89a353c3b5}{\_entry\_lane\_id}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00221}00221         sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1vehicle__schedule_a7329784dde8da0782afa24ae9473a12d}{link\_id}} = veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_aaa9cbe97b2343b3f14841c1ed2bc8e3d}{\_link\_id}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00222}00222         sched.\mbox{\hyperlink{structstreets__vehicle__scheduler_1_1signalized__vehicle__schedule_afdb3b1e43d8f12071f3e4b6b5780ef99}{state}} = \mbox{\hyperlink{namespacestreets__vehicles_a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de}{streets\_vehicles::vehicle\_state::EV}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00223}00223     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00225}00225 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00226}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a616f990b94f85cbe7c8ac5ecc215d41c}{00226}}     uint64\_t \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a616f990b94f85cbe7c8ac5ecc215d41c}{signalized\_vehicle\_scheduler::calculate\_earliest\_entering\_time}}(\textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00227}00227         }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00228}00228         \textcolor{keywordflow}{if} ( veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a54872859b3a12ee290b98e0eedd2864f}{\_cur\_state}} == \mbox{\hyperlink{namespacestreets__vehicles_a41f5c896d8020c141aa96235cf1405aca834d41112f2943c357f660165b6eb6de}{streets\_vehicles::vehicle\_state::EV}}) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00229}00229             \textcolor{comment}{// Distance to stop bar }}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00230}00230             \textcolor{keywordtype}{double} delta\_x = veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a21a6378ca2401ac4bc9ca6f6364833fb}{\_cur\_distance}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00231}00231             \textcolor{comment}{// Get Entry Lane}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00232}00232             \mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info}{OpenAPI::OAILanelet\_info}} entry\_lane =  \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1vehicle__scheduler_af8916add714bef70d8f48efc0ccfca7b}{get\_entry\_lanelet\_info}}( veh );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00233}00233             \textcolor{comment}{// Get Link Lane}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00234}00234             \mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info}{OpenAPI::OAILanelet\_info}} link\_lane =  \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c}{get\_link\_lanelet\_info}}( veh );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00235}00235             \textcolor{comment}{// Distance necessary to get to max speed and decelerate with decel\_max to departure speed}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00236}00236             \textcolor{keywordtype}{double} delta\_x\_prime =  \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a925165d32ec5e00e9e2992df9337010d}{calculate\_distance\_accel\_and\_decel}}( veh, entry\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}(), link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}() );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00237}00237             \textcolor{comment}{// Distance necessary to get to the departure speed}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00238}00238             \textcolor{keywordtype}{double} delta\_x\_zegond =  \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a98775d8dc582750131d1a7daff140397}{calculate\_distance\_accel\_or\_decel}}( veh, link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}() );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00239}00239             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Delta X = \{0\}, Delta X Prime = \{1\}, Delta X Zegond = \{2\}."{}}, delta\_x, delta\_x\_prime, delta\_x\_zegond);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00240}00240 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00241}00241             \textcolor{comment}{// Calculate v\_hat}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00242}00242             \textcolor{keywordtype}{double} v\_hat = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a8d4f24941809d897f4f2bd27d16a41e0}{calculate\_v\_hat}}(veh, entry\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}(), link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}(), delta\_x, delta\_x\_prime, delta\_x\_zegond);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00243}00243             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}V hat = \{0\}."{}}, v\_hat);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00244}00244 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00245}00245             \textcolor{comment}{// calculate planned acceleration time interval}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00246}00246             \textcolor{keywordtype}{double} t\_accel = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a9c75b9f5697f17b55e8ee1749370ce85}{calculate\_acceleration\_time}}(veh, v\_hat, link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}(), delta\_x, delta\_x\_zegond);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00247}00247             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}T accel = \{0\}."{}},t\_accel);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00248}00248 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00249}00249             \textcolor{comment}{// calculate planned deceleration time interval}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00250}00250             \textcolor{keywordtype}{double} t\_decel = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a5b376d76daf797d450e98eee7773ba4a}{calculate\_deceleration\_time}}(veh, v\_hat, link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}(), delta\_x, delta\_x\_zegond);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00251}00251             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}T decel = \{0\}."{}},t\_decel);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00252}00252 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00253}00253             \textcolor{comment}{// Calculate planned cruising time interval}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00254}00254             \textcolor{keywordtype}{double} t\_cruising = \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_af28d893b32779b4c75ab82a38f640169}{calculate\_cruising\_time}}(v\_hat, delta\_x, delta\_x\_prime);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00255}00255             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}T cruising = \{0\}."{}},t\_cruising);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00256}00256             }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00257}00257             \textcolor{comment}{// calculate earliest entering time to stop bar}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00258}00258             \textcolor{keywordtype}{double} eet = t\_accel + t\_cruising + t\_decel;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00259}00259             \textcolor{keywordflow}{if} (eet <= 0) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00260}00260                 SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}The estimated eet for vehicle \{0\} has a negative value = \{1\}!"{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}}, eet);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00261}00261             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00262}00262             \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(ceil(eet * 1000.0)) + veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a278b51810d25efcfcfb91bb13e43e6f3}{\_cur\_time}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00263}00263         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00264}00264         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00265}00265         \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00266}00266             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Cannot estimate the earliest entering time for vehicle \{0\} which is not an EV!"{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00267}00267             \textcolor{keywordflow}{throw} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1scheduling__exception}{scheduling\_exception}}(\textcolor{stringliteral}{"{}Trying to calculate earliest entering time (EET) for a vehicle that is not an EV!"{}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00268}00268         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00269}00269         \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00270}00270     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00271}00271 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00272}00272 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00273}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a925165d32ec5e00e9e2992df9337010d}{00273}}     \textcolor{keywordtype}{double} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a925165d32ec5e00e9e2992df9337010d}{signalized\_vehicle\_scheduler::calculate\_distance\_accel\_and\_decel}}( \textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh, \textcolor{keyword}{const} \textcolor{keywordtype}{double} max\_speed, \textcolor{keyword}{const} \textcolor{keywordtype}{double} departure\_speed)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00274}00274         \textcolor{comment}{// calculate delta x prime}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00275}00275         \textcolor{keywordtype}{double} delta\_x\_prime = ((pow(max\_speed, 2) -\/ pow(veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}, 2)) / (2 * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a1180998ca4eeb7d695d135a1e4a75424}{\_accel\_max}})) + ((pow(departure\_speed, 2) -\/ pow(max\_speed, 2)) / (2 * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a253341595deb3473620116dcf63d9927}{\_decel\_max}}));}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00276}00276         \textcolor{keywordflow}{return}  delta\_x\_prime;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00277}00277     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00278}00278 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00279}00279 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00280}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a98775d8dc582750131d1a7daff140397}{00280}}     \textcolor{keywordtype}{double} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a98775d8dc582750131d1a7daff140397}{signalized\_vehicle\_scheduler::calculate\_distance\_accel\_or\_decel}}( \textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh, \textcolor{keyword}{const} \textcolor{keywordtype}{double} departure\_speed )\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00281}00281         \textcolor{comment}{// calculate delta x zegond}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00282}00282         \textcolor{keywordtype}{double} delta\_x\_zegond;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00283}00283         \textcolor{keywordflow}{if} (veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}} <= departure\_speed) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00284}00284             delta\_x\_zegond = (pow(departure\_speed, 2) -\/ pow(veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}, 2)) / (2 * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a1180998ca4eeb7d695d135a1e4a75424}{\_accel\_max}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00285}00285         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00286}00286         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00287}00287             delta\_x\_zegond = (pow(departure\_speed, 2) -\/ pow(veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}, 2)) / (2 * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a253341595deb3473620116dcf63d9927}{\_decel\_max}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00288}00288         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00289}00289         \textcolor{keywordflow}{return}  delta\_x\_zegond;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00290}00290     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00291}00291 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00292}00292 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00293}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a8d4f24941809d897f4f2bd27d16a41e0}{00293}}     \textcolor{keywordtype}{double} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a8d4f24941809d897f4f2bd27d16a41e0}{signalized\_vehicle\_scheduler::calculate\_v\_hat}}( \textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh, \textcolor{keyword}{const} \textcolor{keywordtype}{double} max\_speed, \textcolor{keyword}{const} \textcolor{keywordtype}{double} departure\_speed, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x\_prime, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x\_zegond )\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00294}00294         \textcolor{keywordflow}{if} (delta\_x >= delta\_x\_prime) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00295}00295             \textcolor{keywordflow}{return} max\_speed;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00296}00296         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00297}00297         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (delta\_x\_prime > delta\_x \&\& delta\_x >= delta\_x\_zegond) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00298}00298             \textcolor{keywordtype}{double} numerator = (2 * delta\_x * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a253341595deb3473620116dcf63d9927}{\_decel\_max}} * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a1180998ca4eeb7d695d135a1e4a75424}{\_accel\_max}}) + (veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a253341595deb3473620116dcf63d9927}{\_decel\_max}} * pow(veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}, 2)) -\/ (veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a1180998ca4eeb7d695d135a1e4a75424}{\_accel\_max}} * pow(departure\_speed, 2));}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00299}00299             \textcolor{keywordtype}{double} denominator = veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a253341595deb3473620116dcf63d9927}{\_decel\_max}} -\/ veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a1180998ca4eeb7d695d135a1e4a75424}{\_accel\_max}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00300}00300             \textcolor{keywordflow}{return} sqrt(numerator/denominator);}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00301}00301         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00302}00302         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00303}00303             \textcolor{keywordflow}{if} (veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}} <= departure\_speed) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00304}00304                 \textcolor{keywordflow}{return} sqrt((2 * delta\_x * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a1180998ca4eeb7d695d135a1e4a75424}{\_accel\_max}}) + pow(veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}, 2));}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00305}00305             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00306}00306             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00307}00307                 \textcolor{keywordflow}{return} sqrt((2 * delta\_x * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a253341595deb3473620116dcf63d9927}{\_decel\_max}}) + pow(veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}, 2));}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00308}00308             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00309}00309         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00310}00310     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00311}00311 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00313}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a9c75b9f5697f17b55e8ee1749370ce85}{00313}}     \textcolor{keywordtype}{double} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a9c75b9f5697f17b55e8ee1749370ce85}{signalized\_vehicle\_scheduler::calculate\_acceleration\_time}}(\textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh, \textcolor{keyword}{const} \textcolor{keywordtype}{double} v\_hat, \textcolor{keyword}{const} \textcolor{keywordtype}{double} departure\_speed, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x\_zegond)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00314}00314         \textcolor{keywordtype}{double} t\_accel = 0.0;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00315}00315         \textcolor{keywordflow}{if} (delta\_x >= delta\_x\_zegond || departure\_speed >= veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}})\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00316}00316             \textcolor{keywordflow}{if} (v\_hat >= veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00317}00317                 t\_accel = (v\_hat -\/ veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}) / veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a1180998ca4eeb7d695d135a1e4a75424}{\_accel\_max}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00318}00318             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00319}00319             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00320}00320                 SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Negative acceleration time interval is calculated for vehicle \{0\}. The acceleration time interval is set to 0."{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00321}00321             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00322}00322         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00323}00323         \textcolor{keywordflow}{return} t\_accel;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00324}00324     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00325}00325 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00327}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a5b376d76daf797d450e98eee7773ba4a}{00327}}     \textcolor{keywordtype}{double} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a5b376d76daf797d450e98eee7773ba4a}{signalized\_vehicle\_scheduler::calculate\_deceleration\_time}}(\textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh, \textcolor{keyword}{const} \textcolor{keywordtype}{double} v\_hat, \textcolor{keyword}{const} \textcolor{keywordtype}{double} departure\_speed, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x\_zegond)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00328}00328         \textcolor{keywordtype}{double} t\_decel = 0.0;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00329}00329         \textcolor{keywordflow}{if} (delta\_x < delta\_x\_zegond \&\& departure\_speed < veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00330}00330             \textcolor{keywordflow}{if} (v\_hat <= veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00331}00331                 t\_decel = (v\_hat -\/ veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}) / veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a253341595deb3473620116dcf63d9927}{\_decel\_max}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00332}00332             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00333}00333             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00334}00334                 SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Negative deceleration time interval is calculated for vehicle \{0\}. The deceleration time interval is set to 0."{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00335}00335             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00336}00336         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00337}00337         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (delta\_x >= delta\_x\_zegond) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00338}00338             \textcolor{keywordflow}{if} (v\_hat >= departure\_speed) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00339}00339                 t\_decel = (departure\_speed -\/ v\_hat) / veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a253341595deb3473620116dcf63d9927}{\_decel\_max}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00340}00340             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00341}00341             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00342}00342                 SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Negative deceleration time interval is calculated for vehicle \{0\}. The deceleration time interval is set to 0."{}}, veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a470605f661a8f625329ebbb10888e2b8}{\_id}});}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00343}00343             \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00344}00344         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00345}00345         \textcolor{keywordflow}{return} t\_decel;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00346}00346     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00347}00347 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00348}00348 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00349}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_af28d893b32779b4c75ab82a38f640169}{00349}}     \textcolor{keywordtype}{double} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_af28d893b32779b4c75ab82a38f640169}{signalized\_vehicle\_scheduler::calculate\_cruising\_time}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} v\_hat, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x, \textcolor{keyword}{const} \textcolor{keywordtype}{double} delta\_x\_prime)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00350}00350         \textcolor{keywordflow}{if} (delta\_x > delta\_x\_prime) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00351}00351             \textcolor{keywordflow}{return} (delta\_x -\/ delta\_x\_prime) / v\_hat;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00352}00352         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00353}00353         \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00354}00354     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00355}00355 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00356}00356 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00357}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a6b1ad1b03c5a472d08448ddaaae63369}{00357}}     uint64\_t \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a6b1ad1b03c5a472d08448ddaaae63369}{signalized\_vehicle\_scheduler::calculate\_min\_headway}}(\textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh, \textcolor{keyword}{const} \textcolor{keywordtype}{double} speed)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00358}00358         }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00359}00359         \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}(ceil( 1000*(veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a5c6b46bfbbb31785e7a07e96bc18ae76}{\_reaction\_time}} + ((veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a8df55ea8c6a305540ae4601f5c770843}{\_length}} + veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a3a38a205ab41c1912245c3d2a3b8c907}{\_min\_gap}})/speed)) ));}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00360}00360     \} }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00362}00362 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00363}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a1cce3f6e4da6ae1804dfd6a49305baf2}{00363}}     uint64\_t \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a1cce3f6e4da6ae1804dfd6a49305baf2}{signalized\_vehicle\_scheduler::estimate\_clearance\_time}}( \textcolor{keyword}{const} \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{streets\_vehicles::vehicle}} \&veh )\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00364}00364         \textcolor{comment}{// Get Link Lane}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00365}00365         \mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info}{OpenAPI::OAILanelet\_info}} link\_lane =  \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1vehicle__scheduler_af2c80eb87e5a9cabaad660544003663c}{get\_link\_lanelet\_info}}( veh );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00366}00366         \textcolor{keywordflow}{if} ( veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a54872859b3a12ee290b98e0eedd2864f}{\_cur\_state}} == \mbox{\hyperlink{namespacestreets__vehicles_a41f5c896d8020c141aa96235cf1405aca58d6a88f13e2db7f5059c41047876f00}{streets\_vehicles::vehicle\_state::DV}} ) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00367}00367             \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}( ceil(1000 * veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a21a6378ca2401ac4bc9ca6f6364833fb}{\_cur\_distance}} / veh.\mbox{\hyperlink{structstreets__vehicles_1_1vehicle_a026375b9e6ffc8f8c8aee72465f352dc}{\_cur\_speed}}) );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00368}00368         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00369}00369         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00370}00370             \textcolor{keywordflow}{return} \textcolor{keyword}{static\_cast<}uint64\_t\textcolor{keyword}{>}( ceil(1000 * link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_abc1c4d5d24a2dafb175874ecad09cfad}{getLength}}() / link\_lane.\mbox{\hyperlink{classOpenAPI_1_1OAILanelet__info_a9ed2860829d5aeba3062f26e78afcbdc}{getSpeedLimit}}()) );}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00371}00371         \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00372}00372     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00373}00373 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00375}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a2532494d22760bd75165d7b2c25bc354}{00375}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a2532494d22760bd75165d7b2c25bc354}{signalized\_vehicle\_scheduler::set\_initial\_green\_buffer}}(\textcolor{keyword}{const} uint64\_t buffer)\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00376}00376         \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aed5f596d0160b7fc2941f8f003293f50}{initial\_green\_buffer}} = buffer;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00377}00377     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00378}00378 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00379}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a0c1c065ffbe9ecd62e2a985815aa8170}{00379}}     uint64\_t \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a0c1c065ffbe9ecd62e2a985815aa8170}{signalized\_vehicle\_scheduler::get\_initial\_green\_buffer}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00380}00380         \textcolor{keywordflow}{return} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aed5f596d0160b7fc2941f8f003293f50}{initial\_green\_buffer}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00381}00381     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00383}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a9f16f001c3768c180d62ea66a8770151}{00383}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a9f16f001c3768c180d62ea66a8770151}{signalized\_vehicle\_scheduler::set\_final\_green\_buffer}}(\textcolor{keyword}{const} uint64\_t buffer)\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00384}00384         \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_af23ea3f8079aedda1f3e36203d0bc0c9}{final\_green\_buffer}} = buffer;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00385}00385     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00386}00386 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00387}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_afbeb97e551e87ad6340c620b51f28fe1}{00387}}     uint64\_t \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_afbeb97e551e87ad6340c620b51f28fe1}{signalized\_vehicle\_scheduler::get\_final\_green\_buffer}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00388}00388         \textcolor{keywordflow}{return} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_af23ea3f8079aedda1f3e36203d0bc0c9}{final\_green\_buffer}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00389}00389     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00390}00390 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00391}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aa4707ffc16fca19f724911b9f0c0e581}{00391}}     std::shared\_ptr<signal\_phase\_and\_timing::spat> \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aa4707ffc16fca19f724911b9f0c0e581}{signalized\_vehicle\_scheduler::get\_spat}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00392}00392         \textcolor{keywordflow}{return} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aa17cd405d5cda86d877060b915b9aa32}{spat\_ptr}};}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00393}00393     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00395}\mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a31439c5e2c152727be5df25e109ba988}{00395}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_a31439c5e2c152727be5df25e109ba988}{signalized\_vehicle\_scheduler::set\_spat}}(std::shared\_ptr<signal\_phase\_and\_timing::spat> spat\_info) \{}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00396}00396         \mbox{\hyperlink{classstreets__vehicle__scheduler_1_1signalized__vehicle__scheduler_aa17cd405d5cda86d877060b915b9aa32}{spat\_ptr}} = spat\_info;}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00397}00397     \}}
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00398}00398     }
\DoxyCodeLine{\Hypertarget{signalized__vehicle__scheduler_8cpp_source_l00399}00399 \}}

\end{DoxyCode}
