\hypertarget{kafka__producer__worker_8cpp_source}{}\doxysection{kafka\+\_\+producer\+\_\+worker.\+cpp}
\label{kafka__producer__worker_8cpp_source}\index{kafka\_clients/src/kafka\_producer\_worker.cpp@{kafka\_clients/src/kafka\_producer\_worker.cpp}}
\mbox{\hyperlink{kafka__producer__worker_8cpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00001}00001 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00002}00002 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{kafka__producer__worker_8h}{kafka\_producer\_worker.h}}"{}}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00003}00003 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacekafka__clients}{kafka\_clients}}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00004}00004 \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00005}\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_abff1d3ab487e6533ed0a505d861c96d5}{00005}}     \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_abff1d3ab487e6533ed0a505d861c96d5}{kafka\_producer\_worker::kafka\_producer\_worker}}(\textcolor{keyword}{const} std::string \&brokers, \textcolor{keyword}{const} std::string \&topics, \textcolor{keywordtype}{int} partition)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00006}00006         : \_topics\_str(topics), \_broker\_str(brokers), \_run(true), \_partition(partition)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00007}00007     \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00008}00008         SPDLOG\_INFO(\textcolor{stringliteral}{"{}kafka\_producer\_worker init()... "{}});}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00009}00009     \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00010}00010 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00011}\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a0bc4fc9719a218b561789c217aa8ff80}{00011}}     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a0bc4fc9719a218b561789c217aa8ff80}{kafka\_producer\_worker::init}}()}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00012}00012     \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00013}00013         std::string errstr = \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00015}00015         \textcolor{comment}{// Create configuration objects}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00016}00016         RdKafka::Conf *\mbox{\hyperlink{namespaceconf}{conf}} = RdKafka::Conf::create(RdKafka::Conf::CONF\_GLOBAL);}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00017}00017         RdKafka::Conf *tconf = RdKafka::Conf::create(RdKafka::Conf::CONF\_TOPIC);}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00019}00019 \textcolor{comment}{        /***}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00020}00020 \textcolor{comment}{         * Set Configuration properties}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00021}00021 \textcolor{comment}{         */}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00022}00022         \textcolor{comment}{// set broker list}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00023}00023         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceconf}{conf}}-\/>set(\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a0e130dd02a30f05539120cb5ba477510}{BOOTSTRAP\_SERVER}}, \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a38bf3fabc40b1db6b4850b335cf6fe4b}{\_broker\_str}}, errstr) != RdKafka::Conf::CONF\_OK)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00024}00024         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00025}00025             SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}RdKafka conf set brokerlist failed: \{0\} "{}}, errstr.c\_str());}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00026}00026             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00027}00027         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00029}00029         \textcolor{comment}{// set delivery report callback}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00030}00030         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceconf}{conf}}-\/>set(\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a15f3f181dd5c04c64d04bb6473ae2cac}{DR\_CB}}, \&\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_aa172375ad141af4a27bdb852a7492026}{\_producer\_delivery\_report\_cb}}, errstr) != RdKafka::Conf::CONF\_OK)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00031}00031         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00032}00032             SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}RdKafka conf set delivery report callback failed:   \{0\}"{}}, errstr.c\_str());}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00033}00033             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00034}00034         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00035}00035 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00036}00036         \textcolor{comment}{// set event callback}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00037}00037         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceconf}{conf}}-\/>set(\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a12fac0bb7e9d9fe2425ff506948c51ea}{EVENT\_CB}}, \&\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_aa71379a7f3bec4a50216eefdd03c640e}{\_producer\_event\_cb}}, errstr) != RdKafka::Conf::CONF\_OK)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00038}00038         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00039}00039             SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}RdKafka conf set event callback failed: \{0\} "{}}, errstr.c\_str());}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00040}00040             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00041}00041         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00043}00043         \textcolor{comment}{// create producer using accumulated global configuration.}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00044}00044         \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}} = RdKafka::Producer::create(\mbox{\hyperlink{namespaceconf}{conf}}, errstr);}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00045}00045         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}})}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00046}00046         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00047}00047             SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Failed to create producer:  \{0\} "{}}, errstr.c\_str());}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00048}00048             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00049}00049         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00050}00050         \textcolor{keyword}{delete} \mbox{\hyperlink{namespaceconf}{conf}};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00052}00052         SPDLOG\_INFO(\textcolor{stringliteral}{"{}created producer:  \{:>8\} "{}}, \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>name());}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00054}00054         \textcolor{comment}{// Create topic handle}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00055}00055         \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a65e51a375deafee6c444020c57037084}{\_topic}} = RdKafka::Topic::create(\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}, \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a0b385423f1b004ef8dd4cb1a276cb6b2}{\_topics\_str}}, tconf, errstr);}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00056}00056         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a65e51a375deafee6c444020c57037084}{\_topic}})}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00057}00057         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00058}00058             SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Failed to create producer:  \{0\} "{}}, errstr.c\_str());}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00060}00060             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00061}00061         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00062}00062         \textcolor{keyword}{delete} tconf;}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00063}00063         \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_aaa1ce1c199b4fd69c59dd715294aabb4}{printCurrConf}}();}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00064}00064         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00065}00065     \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00066}00066 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00067}\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a5df1a42e8557ac55bb60b71fd007dec0}{00067}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a5df1a42e8557ac55bb60b71fd007dec0}{kafka\_producer\_worker::send}}(\textcolor{keyword}{const} std::string \&msg)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00068}00068     \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00069}00069 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00070}00070         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a90d01ae6c611aac0ecd18eef5a74bf3b}{\_run}})}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00071}00071             \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00073}00073         \textcolor{keywordflow}{if} (msg.empty())}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00074}00074         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00075}00075             \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>poll(0);}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00076}00076             \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00077}00077         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00078}00078 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00079}00079         \textcolor{comment}{// produce messages}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00080}00080         \textcolor{keywordflow}{while} (\textcolor{keyword}{true})}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00081}00081         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00082}00082             RdKafka::ErrorCode resp = \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>produce(\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a65e51a375deafee6c444020c57037084}{\_topic}},}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00083}00083                                                          \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a5ca099fa0f72e3758455930bf7957905}{\_partition}},}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00084}00084                                                          RdKafka::Producer::RK\_MSG\_COPY,}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00085}00085                                                          \textcolor{keyword}{const\_cast<}\textcolor{keywordtype}{char} *\textcolor{keyword}{>}(msg.c\_str()),}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00086}00086                                                          msg.size(),}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00087}00087                                                          NULL,}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00088}00088                                                          NULL);}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00089}00089             \textcolor{keywordflow}{if} (resp != RdKafka::ERR\_NO\_ERROR)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00090}00090             \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00091}00091                 SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{} \{0\} Produce failed:  \{1\} "{}}, \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>name(), RdKafka::err2str(resp));}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00092}00092                 \textcolor{keywordflow}{if} (resp == RdKafka::ERR\_\_QUEUE\_FULL)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00093}00093                 \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00094}00094                     \textcolor{comment}{/* If the internal queue is full, wait for}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00095}00095 \textcolor{comment}{                     * messages to be delivered and then retry.}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00096}00096 \textcolor{comment}{                     * The internal queue represents both}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00097}00097 \textcolor{comment}{                     * messages to be sent and messages that have}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00098}00098 \textcolor{comment}{                     * been sent or failed, awaiting their}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00099}00099 \textcolor{comment}{                     * delivery report callback to be called.}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00100}00100 \textcolor{comment}{                     *}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00101}00101 \textcolor{comment}{                     * The internal queue is limited by the}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00102}00102 \textcolor{comment}{                     * configuration property}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00103}00103 \textcolor{comment}{                     * queue.buffering.max.messages */}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00104}00104                     \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>poll(1000 \textcolor{comment}{/*block for max 1000ms*/});}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00105}00105                     \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00106}00106                 \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00107}00107             \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00108}00108             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00109}00109             \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00110}00110                 SPDLOG\_DEBUG(\textcolor{stringliteral}{"{} \{0\} Produced message ( \{1\}  bytes ) , message content:  \{2\}"{}}, \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>name(), msg.size(), msg.c\_str());}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00111}00111             \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00112}00112 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00113}00113             \textcolor{comment}{// break the loop regardless of sucessfully sent or failed}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00114}00114             \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00115}00115         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00116}00116 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00117}00117         \textcolor{comment}{/* A producer application should continually serve}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00118}00118 \textcolor{comment}{         * the delivery report queue by calling poll()}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00119}00119 \textcolor{comment}{         * at frequent intervals.}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00120}00120 \textcolor{comment}{         * Either put the poll call in your main loop, or in a}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00121}00121 \textcolor{comment}{         * dedicated thread, or call it after every produce() call.}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00122}00122 \textcolor{comment}{         * Just make sure that poll() is still called}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00123}00123 \textcolor{comment}{         * during periods where you are not producing any messages}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00124}00124 \textcolor{comment}{         * to make sure previously produced messages have their}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00125}00125 \textcolor{comment}{         * delivery report callback served (and any other callbacks}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00126}00126 \textcolor{comment}{         * you register). */}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00127}00127         \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>poll(0);}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00128}00128     \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00130}\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_aa980d0bb119c78f73ea9bc1ac3abdd1a}{00130}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_aa980d0bb119c78f73ea9bc1ac3abdd1a}{kafka\_producer\_worker::stop}}()}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00131}00131     \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00132}00132         \textcolor{comment}{/* Wait for final messages to be delivered or fail.}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00133}00133 \textcolor{comment}{         * flush() is an abstraction over poll() which}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00134}00134 \textcolor{comment}{         * waits for all messages to be delivered. */}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00135}00135         \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a90d01ae6c611aac0ecd18eef5a74bf3b}{\_run}} = \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00136}00136         SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Stopping producer client.. "{}});}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00137}00137         SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Flushing final messages... "{}});}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00138}00138         \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00139}00139         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00140}00140             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}})}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00141}00141             \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00142}00142                 \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>flush(10 * 1000 \textcolor{comment}{/* wait for max 10 seconds */});}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00143}00143 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00144}00144                 \textcolor{keywordflow}{if} (\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>outq\_len() > 0)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00145}00145                     SPDLOG\_INFO(\textcolor{stringliteral}{"{}  \{0\} \{1\} message(s) were not delivered  "{}}, \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>name(), \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_ad24185bcbdf6f674d7b1e81eb6aee89e}{\_producer}}-\/>outq\_len());}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00146}00146             \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00147}00147         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00148}00148         \textcolor{keywordflow}{catch} (...)}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00149}00149         \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00150}00150 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00151}00151             SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Flushing final messages.??.. "{}});}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00152}00152         \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00153}00153     \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00154}00154 }
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00155}\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_aaa1ce1c199b4fd69c59dd715294aabb4}{00155}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_aaa1ce1c199b4fd69c59dd715294aabb4}{kafka\_producer\_worker::printCurrConf}}()}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00156}00156     \{}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00157}00157         SPDLOG\_INFO(\textcolor{stringliteral}{"{}Producer connect to bootstrap\_server: \{0\}, topic: \{1\} ,partition: \{2\} "{}},}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00158}00158                      (\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a38bf3fabc40b1db6b4850b335cf6fe4b}{\_broker\_str}}.empty() ? \textcolor{stringliteral}{"{}UNKNOWN"{}} : \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a38bf3fabc40b1db6b4850b335cf6fe4b}{\_broker\_str}}), (\mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a0b385423f1b004ef8dd4cb1a276cb6b2}{\_topics\_str}}.empty() ? \textcolor{stringliteral}{"{}UNKNOWN"{}} : \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a0b385423f1b004ef8dd4cb1a276cb6b2}{\_topics\_str}}), \mbox{\hyperlink{classkafka__clients_1_1kafka__producer__worker_a5ca099fa0f72e3758455930bf7957905}{\_partition}});}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00159}00159     \}}
\DoxyCodeLine{\Hypertarget{kafka__producer__worker_8cpp_source_l00160}00160 \}}

\end{DoxyCode}
