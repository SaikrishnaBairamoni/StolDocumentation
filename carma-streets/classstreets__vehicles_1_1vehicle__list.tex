\hypertarget{classstreets__vehicles_1_1vehicle__list}{}\doxysection{streets\+\_\+vehicles\+::vehicle\+\_\+list Class Reference}
\label{classstreets__vehicles_1_1vehicle__list}\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}


Class to store vehicle information for all vehicles in an intersection. Contains pointer to a \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} which holds business logic to process status and intent vehicle updates. To implement custom message processing simply extend \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} and set this object to be the message processor for you vehicle list.  




{\ttfamily \#include $<$vehicle\+\_\+list.\+h$>$}



Collaboration diagram for streets\+\_\+vehicles\+::vehicle\+\_\+list\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classstreets__vehicles_1_1vehicle__list__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a3c2f833e66447f0efb287a315dbe4103}{vehicle\+\_\+list}} ()=default
\begin{DoxyCompactList}\small\item\em Construct a new vehicle list object. \end{DoxyCompactList}\item 
std\+::unordered\+\_\+map$<$ std\+::string, \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} $>$ \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a1d9105cbed952c64d0618d6e4bb6f6c4}{get\+\_\+vehicles}} ()
\begin{DoxyCompactList}\small\item\em Get the vehicles map. \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} $>$ \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a202a7cdf741d9d64857288dd797b075f}{get\+\_\+vehicles\+\_\+by\+\_\+lane}} (const int lane\+\_\+id)
\begin{DoxyCompactList}\small\item\em Get the vehicles by lane id. \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} $>$ \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a64abd8cac7ed0858117cd997de976afc}{get\+\_\+vehicles\+\_\+by\+\_\+state}} (const \mbox{\hyperlink{namespacestreets__vehicles_a41f5c896d8020c141aa96235cf1405ac}{vehicle\+\_\+state}} state)
\begin{DoxyCompactList}\small\item\em Get the vehicles by state. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a4c70ccdc6e01a3bda8dd6ede9a29ad46}{process\+\_\+update}} (const std\+::string \&update)
\begin{DoxyCompactList}\small\item\em Process JSON status and intent update into vehicle update and modifies vehicle map with update. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a96b773f80c8d5f05291ac4c75cc293e9}{set\+\_\+processor}} (std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} $>$ \+\_\+processor)
\begin{DoxyCompactList}\small\item\em Set the \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} to allow for customizable update processing. \end{DoxyCompactList}\item 
std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} $>$ \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_ada45864c474184e09e08f52488fd9e84}{get\+\_\+processor}} ()
\begin{DoxyCompactList}\small\item\em Get the processor object. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a3a8d9a00c7071e4221b4677035974557}{clear}} ()
\begin{DoxyCompactList}\small\item\em Clear vehicle list. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a832fa570b8e2cf14e2844df1ef3b4f24}{add\+\_\+vehicle}} (const \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} \&\mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}})
\begin{DoxyCompactList}\small\item\em Adds a vehicle to the vehicle map. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a57317c5236b9aa537f63271a7af1dfda}{update\+\_\+vehicle}} (const \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} \&\mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}})
\begin{DoxyCompactList}\small\item\em Updates a vehicle in the vehicle map, with new vehicle information. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a6bffe794f9109491bf6c5c9d2b673b5d}{purge\+\_\+old\+\_\+vehicles}} (const uint64\+\_\+t timeout)
\begin{DoxyCompactList}\small\item\em Removes all vehicles in map that have not been updated in timeout period. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::unordered\+\_\+map$<$ std\+::string, \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} $>$ \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}
\item 
std\+::shared\+\_\+mutex \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_af89704297beaa9d07679743b0effa22a}{vehicle\+\_\+list\+\_\+lock}}
\item 
std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} $>$ \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}{processor}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Class to store vehicle information for all vehicles in an intersection. Contains pointer to a \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} which holds business logic to process status and intent vehicle updates. To implement custom message processing simply extend \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} and set this object to be the message processor for you vehicle list. 

\begin{DoxyAuthor}{Author}
Paul Bourelly 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{vehicle__list_8h_source_l00022}{22}} of file \mbox{\hyperlink{vehicle__list_8h_source}{vehicle\+\_\+list.\+h}}.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a3c2f833e66447f0efb287a315dbe4103}\label{classstreets__vehicles_1_1vehicle__list_a3c2f833e66447f0efb287a315dbe4103}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!vehicle\_list@{vehicle\_list}}
\index{vehicle\_list@{vehicle\_list}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{vehicle\_list()}{vehicle\_list()}}
{\footnotesize\ttfamily streets\+\_\+vehicles\+::vehicle\+\_\+list\+::vehicle\+\_\+list (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [default]}}



Construct a new vehicle list object. 



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a832fa570b8e2cf14e2844df1ef3b4f24}\label{classstreets__vehicles_1_1vehicle__list_a832fa570b8e2cf14e2844df1ef3b4f24}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!add\_vehicle@{add\_vehicle}}
\index{add\_vehicle@{add\_vehicle}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{add\_vehicle()}{add\_vehicle()}}
{\footnotesize\ttfamily void streets\+\_\+vehicles\+::vehicle\+\_\+list\+::add\+\_\+vehicle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} \&}]{vehicle }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Adds a vehicle to the vehicle map. 


\begin{DoxyParams}{Parameters}
{\em vehicle} & to add. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00038}{38}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00038                                                      \{}
\DoxyCodeLine{00039         \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.insert(std::pair<std::string, vehicle>(\{veh.\_id,veh\}));}
\DoxyCodeLine{00040     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle_8h_source_l00037}{streets\+\_\+vehicles\+::vehicle\+::\+\_\+id}}, and \mbox{\hyperlink{vehicle__list_8h_source_l00026}{vehicles}}.



Referenced by \mbox{\hyperlink{vehicle__list_8cpp_source_l00068}{process\+\_\+update()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classstreets__vehicles_1_1vehicle__list_a832fa570b8e2cf14e2844df1ef3b4f24_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a3a8d9a00c7071e4221b4677035974557}\label{classstreets__vehicles_1_1vehicle__list_a3a8d9a00c7071e4221b4677035974557}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!clear@{clear}}
\index{clear@{clear}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{clear()}{clear()}}
{\footnotesize\ttfamily void streets\+\_\+vehicles\+::vehicle\+\_\+list\+::clear (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Clear vehicle list. 



Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00113}{113}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00113                              \{}
\DoxyCodeLine{00114         \textcolor{comment}{// Write Lock}}
\DoxyCodeLine{00115         std::unique\_lock  lock(\mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_af89704297beaa9d07679743b0effa22a}{vehicle\_list\_lock}});}
\DoxyCodeLine{00116         SPDLOG\_WARN(\textcolor{stringliteral}{"{}Clearing Vehicle list!"{}});}
\DoxyCodeLine{00117         \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.clear();}
\DoxyCodeLine{00118 }
\DoxyCodeLine{00119     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle__list_8h_source_l00028}{vehicle\+\_\+list\+\_\+lock}}, and \mbox{\hyperlink{vehicle__list_8h_source_l00026}{vehicles}}.

\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_ada45864c474184e09e08f52488fd9e84}\label{classstreets__vehicles_1_1vehicle__list_ada45864c474184e09e08f52488fd9e84}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!get\_processor@{get\_processor}}
\index{get\_processor@{get\_processor}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{get\_processor()}{get\_processor()}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} $>$ streets\+\_\+vehicles\+::vehicle\+\_\+list\+::get\+\_\+processor (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Get the processor object. 

\begin{DoxyReturn}{Returns}
std\+::unique\+\_\+ptr$<$status\+\_\+intent\+\_\+processor$>$ 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00108}{108}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00108                                                                        \{}
\DoxyCodeLine{00109         \textcolor{comment}{// Read lock}}
\DoxyCodeLine{00110         \textcolor{keywordflow}{return} \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}{processor}};}
\DoxyCodeLine{00111     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle__list_8h_source_l00029}{processor}}.

\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a1d9105cbed952c64d0618d6e4bb6f6c4}\label{classstreets__vehicles_1_1vehicle__list_a1d9105cbed952c64d0618d6e4bb6f6c4}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!get\_vehicles@{get\_vehicles}}
\index{get\_vehicles@{get\_vehicles}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{get\_vehicles()}{get\_vehicles()}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$ std\+::string, \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} $>$ streets\+\_\+vehicles\+::vehicle\+\_\+list\+::get\+\_\+vehicles (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Get the vehicles map. 

\begin{DoxyReturn}{Returns}
std\+::unordered\+\_\+map$<$std\+::string, vehicle$>$ . 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00032}{32}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00032                                                                    \{}
\DoxyCodeLine{00033         \textcolor{comment}{// Read Lock}}
\DoxyCodeLine{00034         std::shared\_lock  lock(\mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_af89704297beaa9d07679743b0effa22a}{vehicle\_list\_lock}});}
\DoxyCodeLine{00035         \textcolor{keywordflow}{return} \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}};}
\DoxyCodeLine{00036     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle__list_8h_source_l00028}{vehicle\+\_\+list\+\_\+lock}}, and \mbox{\hyperlink{vehicle__list_8h_source_l00026}{vehicles}}.

\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a202a7cdf741d9d64857288dd797b075f}\label{classstreets__vehicles_1_1vehicle__list_a202a7cdf741d9d64857288dd797b075f}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!get\_vehicles\_by\_lane@{get\_vehicles\_by\_lane}}
\index{get\_vehicles\_by\_lane@{get\_vehicles\_by\_lane}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{get\_vehicles\_by\_lane()}{get\_vehicles\_by\_lane()}}
{\footnotesize\ttfamily std\+::vector$<$ \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} $>$ streets\+\_\+vehicles\+::vehicle\+\_\+list\+::get\+\_\+vehicles\+\_\+by\+\_\+lane (\begin{DoxyParamCaption}\item[{const int}]{lane\+\_\+id }\end{DoxyParamCaption})}



Get the vehicles by lane id. 


\begin{DoxyParams}{Parameters}
{\em lane\+\_\+id} & lanelet2 map lane id. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::vector$<$vehicle$>$ 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00006}{6}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00006                                                                             \{}
\DoxyCodeLine{00007         std::vector<vehicle> vehicles\_in\_entry\_lane;}
\DoxyCodeLine{00008         \textcolor{comment}{// Read lock}}
\DoxyCodeLine{00009         std::shared\_lock  lock(\mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_af89704297beaa9d07679743b0effa22a}{vehicle\_list\_lock}});}
\DoxyCodeLine{00010         \textcolor{keywordflow}{for} ( \textcolor{keyword}{auto} it = \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.begin(); it != \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.end(); it ++ ) \{}
\DoxyCodeLine{00011             \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}} veh =it-\/>second;}
\DoxyCodeLine{00012             \textcolor{keywordflow}{if} ( veh.\_cur\_lane\_id == lane\_id ) \{}
\DoxyCodeLine{00013                 vehicles\_in\_entry\_lane.push\_back(veh);}
\DoxyCodeLine{00014             \}}
\DoxyCodeLine{00015         \}}
\DoxyCodeLine{00016         \textcolor{keywordflow}{return} vehicles\_in\_entry\_lane;}
\DoxyCodeLine{00017     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle_8h_source_l00049}{streets\+\_\+vehicles\+::vehicle\+::\+\_\+cur\+\_\+lane\+\_\+id}}, \mbox{\hyperlink{vehicle__list_8h_source_l00028}{vehicle\+\_\+list\+\_\+lock}}, and \mbox{\hyperlink{vehicle__list_8h_source_l00026}{vehicles}}.

\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a64abd8cac7ed0858117cd997de976afc}\label{classstreets__vehicles_1_1vehicle__list_a64abd8cac7ed0858117cd997de976afc}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!get\_vehicles\_by\_state@{get\_vehicles\_by\_state}}
\index{get\_vehicles\_by\_state@{get\_vehicles\_by\_state}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{get\_vehicles\_by\_state()}{get\_vehicles\_by\_state()}}
{\footnotesize\ttfamily std\+::vector$<$ \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} $>$ streets\+\_\+vehicles\+::vehicle\+\_\+list\+::get\+\_\+vehicles\+\_\+by\+\_\+state (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{namespacestreets__vehicles_a41f5c896d8020c141aa96235cf1405ac}{vehicle\+\_\+state}}}]{state }\end{DoxyParamCaption})}



Get the vehicles by state. 


\begin{DoxyParams}{Parameters}
{\em state} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
std\+::vector$<$vehicle$>$ 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00019}{19}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00019                                                                                       \{}
\DoxyCodeLine{00020         std::vector<vehicle> vehicle\_in\_state;}
\DoxyCodeLine{00021         \textcolor{comment}{// Read Lock}}
\DoxyCodeLine{00022         std::shared\_lock  lock(\mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_af89704297beaa9d07679743b0effa22a}{vehicle\_list\_lock}});}
\DoxyCodeLine{00023         \textcolor{keywordflow}{for} ( \textcolor{keyword}{auto} it = \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.begin(); it != \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.end(); it ++ ) \{}
\DoxyCodeLine{00024             \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}} veh =it-\/>second;}
\DoxyCodeLine{00025             \textcolor{keywordflow}{if} ( veh.\_cur\_state == state ) \{}
\DoxyCodeLine{00026                 vehicle\_in\_state.push\_back(veh);}
\DoxyCodeLine{00027             \}}
\DoxyCodeLine{00028         \}}
\DoxyCodeLine{00029         \textcolor{keywordflow}{return} vehicle\_in\_state;}
\DoxyCodeLine{00030     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle_8h_source_l00079}{streets\+\_\+vehicles\+::vehicle\+::\+\_\+cur\+\_\+state}}, \mbox{\hyperlink{vehicle__list_8h_source_l00028}{vehicle\+\_\+list\+\_\+lock}}, and \mbox{\hyperlink{vehicle__list_8h_source_l00026}{vehicles}}.

\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a4c70ccdc6e01a3bda8dd6ede9a29ad46}\label{classstreets__vehicles_1_1vehicle__list_a4c70ccdc6e01a3bda8dd6ede9a29ad46}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!process\_update@{process\_update}}
\index{process\_update@{process\_update}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{process\_update()}{process\_update()}}
{\footnotesize\ttfamily void streets\+\_\+vehicles\+::vehicle\+\_\+list\+::process\+\_\+update (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{update }\end{DoxyParamCaption})}



Process JSON status and intent update into vehicle update and modifies vehicle map with update. 


\begin{DoxyParams}{Parameters}
{\em update} & std\+::string status and intent JSON vehicle update \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00068}{68}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00068                                                                \{}
\DoxyCodeLine{00069       }
\DoxyCodeLine{00070         \textcolor{keywordflow}{if} ( \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}{processor}} != \textcolor{keyword}{nullptr} ) \{}
\DoxyCodeLine{00071             \textcolor{comment}{// Write lock for purge/update/add}}
\DoxyCodeLine{00072             std::unique\_lock  lock(\mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_af89704297beaa9d07679743b0effa22a}{vehicle\_list\_lock}});}
\DoxyCodeLine{00073             \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a6bffe794f9109491bf6c5c9d2b673b5d}{purge\_old\_vehicles}}( \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}{processor}}-\/>get\_timeout());}
\DoxyCodeLine{00074             \textcolor{keywordflow}{try}\{}
\DoxyCodeLine{00075                 \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}} \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}};}
\DoxyCodeLine{00076                 rapidjson::Document doc;}
\DoxyCodeLine{00077                 std::string v\_id = \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}{processor}}-\/>get\_vehicle\_id(update, doc);}
\DoxyCodeLine{00078                 \textcolor{keywordflow}{if} ( \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.find(v\_id) != \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.end() ) \{}
\DoxyCodeLine{00079                     \textcolor{comment}{// If vehicle is already in Vehicle List, update vehicle}}
\DoxyCodeLine{00080                     \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}} = \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.find(v\_id)-\/>second;}
\DoxyCodeLine{00081                     \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}{processor}}-\/>process\_status\_intent( doc, vehicle);}
\DoxyCodeLine{00082                     \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a57317c5236b9aa537f63271a7af1dfda}{update\_vehicle}}(vehicle);}
\DoxyCodeLine{00083                     SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Update Vehicle : \{0\}"{}} , \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}}.\_id);}
\DoxyCodeLine{00084                 \}}
\DoxyCodeLine{00085                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00086                     \textcolor{comment}{// If vehicle is not already in Vehicle list, add vehicle}}
\DoxyCodeLine{00087                     \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}{processor}}-\/>process\_status\_intent( doc, vehicle);}
\DoxyCodeLine{00088                     \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a832fa570b8e2cf14e2844df1ef3b4f24}{add\_vehicle}}(vehicle);}
\DoxyCodeLine{00089                     SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Added Vehicle : \{0\}"{}} , \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}}.\_id);}
\DoxyCodeLine{00090 }
\DoxyCodeLine{00091                 \}}
\DoxyCodeLine{00092             \}}
\DoxyCodeLine{00093             \textcolor{keywordflow}{catch}( \textcolor{keyword}{const} status\_intent\_processing\_exception \&ex) \{}
\DoxyCodeLine{00094                 SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}Failed to parse status and intent update: \{0\}"{}}, ex.what());}
\DoxyCodeLine{00095             \}}
\DoxyCodeLine{00096         \}}
\DoxyCodeLine{00097         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00098             SPDLOG\_CRITICAL(\textcolor{stringliteral}{"{}No status\_intent\_processor available! Set status\_intent\_processor for vehicle\_list!"{}});}
\DoxyCodeLine{00099         \}}
\DoxyCodeLine{00100         }
\DoxyCodeLine{00101     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle_8h_source_l00037}{streets\+\_\+vehicles\+::vehicle\+::\+\_\+id}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00038}{add\+\_\+vehicle()}}, \mbox{\hyperlink{vehicle__list_8h_source_l00029}{processor}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00052}{purge\+\_\+old\+\_\+vehicles()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00042}{update\+\_\+vehicle()}}, \mbox{\hyperlink{vehicle__list_8h_source_l00028}{vehicle\+\_\+list\+\_\+lock}}, and \mbox{\hyperlink{vehicle__list_8h_source_l00026}{vehicles}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classstreets__vehicles_1_1vehicle__list_a4c70ccdc6e01a3bda8dd6ede9a29ad46_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a6bffe794f9109491bf6c5c9d2b673b5d}\label{classstreets__vehicles_1_1vehicle__list_a6bffe794f9109491bf6c5c9d2b673b5d}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!purge\_old\_vehicles@{purge\_old\_vehicles}}
\index{purge\_old\_vehicles@{purge\_old\_vehicles}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{purge\_old\_vehicles()}{purge\_old\_vehicles()}}
{\footnotesize\ttfamily void streets\+\_\+vehicles\+::vehicle\+\_\+list\+::purge\+\_\+old\+\_\+vehicles (\begin{DoxyParamCaption}\item[{const uint64\+\_\+t}]{timeout }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Removes all vehicles in map that have not been updated in timeout period. 


\begin{DoxyParams}{Parameters}
{\em timeout} & time in milliseconds from current time after which vehicles will be removed from the vehicle list. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00052}{52}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00052                                                                   \{}
\DoxyCodeLine{00053         uint64\_t timeout\_time = std::chrono::duration\_cast<std::chrono::milliseconds>(std::chrono::system\_clock::now().time\_since\_epoch()).count() -\/ timeout;}
\DoxyCodeLine{00054         \textcolor{keywordflow}{for} ( \textcolor{keyword}{auto} it = \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.begin(); it != \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.end();  ) \{}
\DoxyCodeLine{00055             \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}} veh =it-\/>second;}
\DoxyCodeLine{00056             SPDLOG\_DEBUG(\textcolor{stringliteral}{"{}Checking Vehicle \{0\} timestamp \{1\} < timeout time \{2\} !"{}}, veh.\_id, veh.\_cur\_time, timeout );}
\DoxyCodeLine{00057             \textcolor{keywordflow}{if} ( veh.\_cur\_time < timeout\_time  ) \{}
\DoxyCodeLine{00058                 SPDLOG\_WARN(\textcolor{stringliteral}{"{}Vehicle \{0\} timed out!"{}}, veh.\_id);}
\DoxyCodeLine{00059                 \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.erase(it ++);}
\DoxyCodeLine{00060             \}}
\DoxyCodeLine{00061             \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{00062                 it ++;}
\DoxyCodeLine{00063             \}}
\DoxyCodeLine{00064         \}}
\DoxyCodeLine{00065 }
\DoxyCodeLine{00066     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle_8h_source_l00071}{streets\+\_\+vehicles\+::vehicle\+::\+\_\+cur\+\_\+time}}, \mbox{\hyperlink{vehicle_8h_source_l00037}{streets\+\_\+vehicles\+::vehicle\+::\+\_\+id}}, and \mbox{\hyperlink{vehicle__list_8h_source_l00026}{vehicles}}.



Referenced by \mbox{\hyperlink{vehicle__list_8cpp_source_l00068}{process\+\_\+update()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classstreets__vehicles_1_1vehicle__list_a6bffe794f9109491bf6c5c9d2b673b5d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a96b773f80c8d5f05291ac4c75cc293e9}\label{classstreets__vehicles_1_1vehicle__list_a96b773f80c8d5f05291ac4c75cc293e9}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!set\_processor@{set\_processor}}
\index{set\_processor@{set\_processor}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{set\_processor()}{set\_processor()}}
{\footnotesize\ttfamily void streets\+\_\+vehicles\+::vehicle\+\_\+list\+::set\+\_\+processor (\begin{DoxyParamCaption}\item[{std\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} $>$}]{\+\_\+processor }\end{DoxyParamCaption})}



Set the \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} to allow for customizable update processing. 


\begin{DoxyParams}{Parameters}
{\em processor} & \mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}} \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00103}{103}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00103                                                                                        \{}
\DoxyCodeLine{00104         \textcolor{comment}{// Write Lock}}
\DoxyCodeLine{00105         \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}{processor}} = \_processor;}
\DoxyCodeLine{00106     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle__list_8h_source_l00029}{processor}}.

\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a57317c5236b9aa537f63271a7af1dfda}\label{classstreets__vehicles_1_1vehicle__list_a57317c5236b9aa537f63271a7af1dfda}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!update\_vehicle@{update\_vehicle}}
\index{update\_vehicle@{update\_vehicle}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{update\_vehicle()}{update\_vehicle()}}
{\footnotesize\ttfamily void streets\+\_\+vehicles\+::vehicle\+\_\+list\+::update\+\_\+vehicle (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}} \&}]{vehicle }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Updates a vehicle in the vehicle map, with new vehicle information. 


\begin{DoxyParams}{Parameters}
{\em vehicle} & new vehicle information to update vehicle with. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{vehicle__list_8cpp_source_l00042}{42}} of file \mbox{\hyperlink{vehicle__list_8cpp_source}{vehicle\+\_\+list.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00042                                                             \{}
\DoxyCodeLine{00043         \textcolor{keyword}{auto} it = \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.find(\mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}}.\_id);}
\DoxyCodeLine{00044         \textcolor{keywordflow}{if} (it != \mbox{\hyperlink{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}{vehicles}}.end()) \{}
\DoxyCodeLine{00045             it-\/>second = \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}};}
\DoxyCodeLine{00046         \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00047             SPDLOG\_WARN(\textcolor{stringliteral}{"{}Did not find vehicle \{0\} to update!"{}}, \mbox{\hyperlink{namespaceintersection__model_aa7ffa99ba647ab571c0bbeb2591c40b8a5a76e813d6a0a40548b91acc11557bd2}{vehicle}}.\_id);}
\DoxyCodeLine{00048         \}}
\DoxyCodeLine{00049     \}}

\end{DoxyCode}


References \mbox{\hyperlink{vehicle_8h_source_l00037}{streets\+\_\+vehicles\+::vehicle\+::\+\_\+id}}, and \mbox{\hyperlink{vehicle__list_8h_source_l00026}{vehicles}}.



Referenced by \mbox{\hyperlink{vehicle__list_8cpp_source_l00068}{process\+\_\+update()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classstreets__vehicles_1_1vehicle__list_a57317c5236b9aa537f63271a7af1dfda_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}\label{classstreets__vehicles_1_1vehicle__list_a99674d65b216322ecc36e07148ce5cb9}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!processor@{processor}}
\index{processor@{processor}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{processor}{processor}}
{\footnotesize\ttfamily std\+::shared\+\_\+ptr$<$\mbox{\hyperlink{classstreets__vehicles_1_1status__intent__processor}{status\+\_\+intent\+\_\+processor}}$>$ streets\+\_\+vehicles\+::vehicle\+\_\+list\+::processor\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{vehicle__list_8h_source_l00029}{29}} of file \mbox{\hyperlink{vehicle__list_8h_source}{vehicle\+\_\+list.\+h}}.



Referenced by \mbox{\hyperlink{vehicle__list_8cpp_source_l00108}{get\+\_\+processor()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00068}{process\+\_\+update()}}, and \mbox{\hyperlink{vehicle__list_8cpp_source_l00103}{set\+\_\+processor()}}.

\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_af89704297beaa9d07679743b0effa22a}\label{classstreets__vehicles_1_1vehicle__list_af89704297beaa9d07679743b0effa22a}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!vehicle\_list\_lock@{vehicle\_list\_lock}}
\index{vehicle\_list\_lock@{vehicle\_list\_lock}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{vehicle\_list\_lock}{vehicle\_list\_lock}}
{\footnotesize\ttfamily std\+::shared\+\_\+mutex streets\+\_\+vehicles\+::vehicle\+\_\+list\+::vehicle\+\_\+list\+\_\+lock\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{vehicle__list_8h_source_l00028}{28}} of file \mbox{\hyperlink{vehicle__list_8h_source}{vehicle\+\_\+list.\+h}}.



Referenced by \mbox{\hyperlink{vehicle__list_8cpp_source_l00113}{clear()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00032}{get\+\_\+vehicles()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00006}{get\+\_\+vehicles\+\_\+by\+\_\+lane()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00019}{get\+\_\+vehicles\+\_\+by\+\_\+state()}}, and \mbox{\hyperlink{vehicle__list_8cpp_source_l00068}{process\+\_\+update()}}.

\mbox{\Hypertarget{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}\label{classstreets__vehicles_1_1vehicle__list_a5f453f61801ffa52db53f5803c817ba5}} 
\index{streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}!vehicles@{vehicles}}
\index{vehicles@{vehicles}!streets\_vehicles::vehicle\_list@{streets\_vehicles::vehicle\_list}}
\doxysubsubsection{\texorpdfstring{vehicles}{vehicles}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$std\+::string, \mbox{\hyperlink{structstreets__vehicles_1_1vehicle}{vehicle}}$>$ streets\+\_\+vehicles\+::vehicle\+\_\+list\+::vehicles\hspace{0.3cm}{\ttfamily [private]}}



Definition at line \mbox{\hyperlink{vehicle__list_8h_source_l00026}{26}} of file \mbox{\hyperlink{vehicle__list_8h_source}{vehicle\+\_\+list.\+h}}.



Referenced by \mbox{\hyperlink{vehicle__list_8cpp_source_l00038}{add\+\_\+vehicle()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00113}{clear()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00032}{get\+\_\+vehicles()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00006}{get\+\_\+vehicles\+\_\+by\+\_\+lane()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00019}{get\+\_\+vehicles\+\_\+by\+\_\+state()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00068}{process\+\_\+update()}}, \mbox{\hyperlink{vehicle__list_8cpp_source_l00052}{purge\+\_\+old\+\_\+vehicles()}}, and \mbox{\hyperlink{vehicle__list_8cpp_source_l00042}{update\+\_\+vehicle()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
streets\+\_\+utils/streets\+\_\+vehicle\+\_\+list/include/\mbox{\hyperlink{vehicle__list_8h}{vehicle\+\_\+list.\+h}}\item 
streets\+\_\+utils/streets\+\_\+vehicle\+\_\+list/src/models/\mbox{\hyperlink{vehicle__list_8cpp}{vehicle\+\_\+list.\+cpp}}\end{DoxyCompactItemize}
