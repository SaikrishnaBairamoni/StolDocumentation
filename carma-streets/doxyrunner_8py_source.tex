\hypertarget{doxyrunner_8py_source}{}\doxysection{doxyrunner.\+py}
\label{doxyrunner_8py_source}\index{doc/\_extensions/zephyr/doxyrunner.py@{doc/\_extensions/zephyr/doxyrunner.py}}
\mbox{\hyperlink{doxyrunner_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00001}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner}{00001}} \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00002}00002 \textcolor{stringliteral}{Doxyrunner Sphinx Plugin}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00003}00003 \textcolor{stringliteral}{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00004}00004 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00005}00005 \textcolor{stringliteral}{Copyright (c) 2021 Nordic Semiconductor ASA}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00006}00006 \textcolor{stringliteral}{SPDX-\/License-\/Identifier: Apache-\/2.0}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00007}00007 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00008}00008 \textcolor{stringliteral}{Introduction}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00009}00009 \textcolor{stringliteral}{============}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00010}00010 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00011}00011 \textcolor{stringliteral}{This Sphinx plugin can be used to run Doxygen build as part of the Sphinx build}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00012}00012 \textcolor{stringliteral}{process. It is meant to be used with other plugins such as ``breathe`` in order}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00013}00013 \textcolor{stringliteral}{to improve the user experience. The principal features offered by this plugin}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00014}00014 \textcolor{stringliteral}{are:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00015}00015 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00016}00016 \textcolor{stringliteral}{-\/ Doxygen build is run before Sphinx reads input files}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00017}00017 \textcolor{stringliteral}{-\/ Doxyfile can be optionally pre-\/processed so that variables can be inserted}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00018}00018 \textcolor{stringliteral}{-\/ Changes in the Doxygen input files are tracked so that Doxygen build is only}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00019}00019 \textcolor{stringliteral}{  run }\textcolor{keywordflow}{if} necessary.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00020}00020 -\/ Synchronizes Doxygen XML output so that even \textcolor{keywordflow}{if} Doxygen \textcolor{keywordflow}{is} run only changed,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00021}00021   deleted \textcolor{keywordflow}{or} added files are modified.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00023}00023 References:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00024}00024 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00025}00025 -\/  https://github.com/michaeljones/breathe/issues/420}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00026}00026 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00027}00027 Configuration options}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00028}00028 =====================}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00030}00030 -\/ ``doxyrunner\_doxygen``: Path to the Doxygen binary.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00031}00031 -\/ ``doxyrunner\_doxyfile``: Path to Doxyfile.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00032}00032 -\/ ``doxyrunner\_outdir``: Doxygen build output directory (inserted to}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00033}00033   ``OUTPUT\_DIRECTORY``)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00034}00034 -\/ ``doxyrunner\_outdir\_var``: Variable representing the Doxygen build output}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00035}00035   directory, \textcolor{keyword}{as} used by ``OUTPUT\_DIRECTORY``. This can be useful \textcolor{keywordflow}{if} other}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00036}00036   Doxygen variables reference to the output directory.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00037}00037 -\/ ``doxyrunner\_fmt``: Flag to indicate \textcolor{keywordflow}{if} Doxyfile should be formatted.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00038}00038 -\/ ``doxyrunner\_fmt\_vars``: Format variables dictionary (name: value).}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00039}00039 -\/ ``doxyrunner\_fmt\_pattern``: Format pattern.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00040}00040 -\/ ``doxyrunner\_silent``: If Doxygen output should be logged \textcolor{keywordflow}{or} \textcolor{keywordflow}{not}. Note that}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00041}00041   this option may \textcolor{keywordflow}{not} have any effect \textcolor{keywordflow}{if} ``QUIET`` \textcolor{keywordflow}{is} set to ``YES``.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00042}00042 \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00043}00043 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00044}00044 \textcolor{stringliteral}{import filecmp}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00045}00045 \textcolor{stringliteral}{import hashlib}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00046}00046 \textcolor{stringliteral}{from pathlib import Path}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00047}00047 \textcolor{stringliteral}{import re}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00048}00048 \textcolor{stringliteral}{import shlex}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00049}00049 \textcolor{stringliteral}{import shutil}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00050}00050 \textcolor{stringliteral}{from subprocess import Popen, PIPE, STDOUT}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00051}00051 \textcolor{stringliteral}{import tempfile}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00052}00052 \textcolor{stringliteral}{from typing import List, Dict, Optional, Any}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00053}00053 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00054}00054 \textcolor{stringliteral}{from sphinx.application import Sphinx}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00055}00055 \textcolor{stringliteral}{from sphinx.environment import BuildEnvironment}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00056}00056 \textcolor{stringliteral}{from sphinx.util import logging}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00057}00057 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00058}00058 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00059}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_aba7137be1453a26c504a07a417053774}{00059}} \textcolor{stringliteral}{\_\_version\_\_ = "{}0.1.0"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00060}00060 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00061}00061 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00062}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a3b3f9cff00699ea6c32f73702fc7e861}{00062}} \textcolor{stringliteral}{logger = logging.getLogger(\_\_name\_\_)}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00063}00063 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00064}00064 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00065}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a7a7998d5bf92a041ce74e5065b6fc255}{00065}} \textcolor{stringliteral}{def hash\_file(file: Path) -\/> str:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00066}00066 \textcolor{stringliteral}{    "{}"{}"{}Compute the hash (SHA256) of a file in text mode.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00067}00067 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00068}00068 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00069}00069 \textcolor{stringliteral}{        file: File to be hashed.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00070}00070 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00071}00071 \textcolor{stringliteral}{    Returns:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00072}00072 \textcolor{stringliteral}{        Hash.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00073}00073 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00074}00074 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00075}00075 \textcolor{stringliteral}{    }\textcolor{keyword}{with} open(file, encoding=\textcolor{stringliteral}{"{}utf-\/8"{}}) \textcolor{keyword}{as} f:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00076}00076         sha256 = hashlib.sha256(f.read().encode(\textcolor{stringliteral}{"{}utf-\/8"{}}))}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00078}00078     \textcolor{keywordflow}{return} sha256.hexdigest()}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00079}00079 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00080}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_add0d4523ccd979592c439a29fbda0cea}{00080}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_add0d4523ccd979592c439a29fbda0cea}{get\_doxygen\_option}}(doxyfile: str, option: str) -\/> List[str]:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00081}00081     \textcolor{stringliteral}{"{}"{}"{}Obtain the value of a Doxygen option.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00082}00082 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00083}00083 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00084}00084 \textcolor{stringliteral}{        doxyfile: Content of the Doxyfile.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00085}00085 \textcolor{stringliteral}{        option: Option to be retrieved.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00086}00086 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00087}00087 \textcolor{stringliteral}{    Notes:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00088}00088 \textcolor{stringliteral}{        Does }\textcolor{keywordflow}{not} support appended values.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00089}00089 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00090}00090     Returns:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00091}00091         Option values.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00092}00092     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00093}00093 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00094}00094 \textcolor{stringliteral}{    option\_re = re.compile(r"{}\string^\(\backslash\)s*([A-\/Z0-\/9\_]+)\(\backslash\)s*=\(\backslash\)s*(.*)\$"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00095}00095     multiline\_re = re.compile(\textcolor{stringliteral}{r"{}\string^\(\backslash\)s*(.*)\$"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00096}00096 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00097}00097     values = []}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00098}00098     found = \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00099}00099     finished = \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00100}00100     \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} doxyfile.splitlines():}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00101}00101         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} found:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00102}00102             m = option\_re.match(line)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00103}00103             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} m \textcolor{keywordflow}{or} m.group(1) != option:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00104}00104                 \textcolor{keywordflow}{continue}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00105}00105 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00106}00106             found = \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00107}00107             value = m.group(2)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00108}00108         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00109}00109             m = multiline\_re.match(line)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00110}00110             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} m:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00111}00111                 \textcolor{keywordflow}{raise} ValueError(f\textcolor{stringliteral}{"{}Unexpected line content: \{line\}"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00112}00112 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00113}00113             value = m.group(1)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00114}00114 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00115}00115         \textcolor{comment}{\# check if it is a multiline value}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00116}00116         finished = \textcolor{keywordflow}{not} value.endswith(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00117}00117 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00118}00118         \textcolor{comment}{\# strip backslash}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00119}00119         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} finished:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00120}00120             value = value[:-\/1]}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00121}00121 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00122}00122         \textcolor{comment}{\# split values}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00123}00123         values += shlex.split(value.replace(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}}, \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)\(\backslash\)\(\backslash\)"{}}))}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00125}00125         \textcolor{keywordflow}{if} finished:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00126}00126             \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00127}00127 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00128}00128     \textcolor{keywordflow}{return} values}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00129}00129 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00131}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_abda974c7596f863ebd4f4820cb1b8deb}{00131}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_abda974c7596f863ebd4f4820cb1b8deb}{process\_doxyfile}}(}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00132}00132     doxyfile: str,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00133}00133     outdir: Path,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00134}00134     silent: bool,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00135}00135     fmt: bool = \textcolor{keyword}{False},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00136}00136     fmt\_pattern: Optional[str] = \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00137}00137     fmt\_vars: Optional[Dict[str, str]] = \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00138}00138     outdir\_var: Optional[str] = \textcolor{keywordtype}{None},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00139}00139 ) -\/> str:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00140}00140     \textcolor{stringliteral}{"{}"{}"{}Process Doxyfile.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00141}00141 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00142}00142 \textcolor{stringliteral}{    Notes:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00143}00143 \textcolor{stringliteral}{        OUTPUT\_DIRECTORY, WARN\_FORMAT }\textcolor{keywordflow}{and} QUIET are overridden to satisfy}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00144}00144         extension operation needs.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00145}00145 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00146}00146     Args:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00147}00147         doxyfile: Path to the Doxyfile.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00148}00148         outdir: Output directory of the Doxygen build.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00149}00149         silent: If Doxygen should be run \textcolor{keywordflow}{in} quiet mode \textcolor{keywordflow}{or} \textcolor{keywordflow}{not}.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00150}00150         fmt: If Doxyfile should be formatted.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00151}00151         fmt\_pattern: Format pattern.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00152}00152         fmt\_vars: Format variables.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00153}00153         outdir\_var: Variable representing output directory.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00154}00154 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00155}00155      Returns:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00156}00156         Processed Doxyfile content.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00157}00157     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00158}00158 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00159}00159 \textcolor{stringliteral}{    }\textcolor{keyword}{with} open(doxyfile) \textcolor{keyword}{as} f:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00160}00160         content = f.read()}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00162}00162     content = re.sub(}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00163}00163         \textcolor{stringliteral}{r"{}\string^\(\backslash\)s*OUTPUT\_DIRECTORY\(\backslash\)s*=.*\$"{}},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00164}00164         f\textcolor{stringliteral}{"{}OUTPUT\_DIRECTORY=\{outdir.as\_posix()\}"{}},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00165}00165         content,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00166}00166         flags=re.MULTILINE,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00167}00167     )}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00169}00169     content = re.sub(}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00170}00170         \textcolor{stringliteral}{r"{}\string^\(\backslash\)s*WARN\_FORMAT\(\backslash\)s*=.*\$"{}},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00171}00171         \textcolor{stringliteral}{'WARN\_FORMAT="{}\$file:\$line: \$text"{}'},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00172}00172         content,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00173}00173         flags=re.MULTILINE,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00174}00174     )}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00176}00176     content = re.sub(}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00177}00177         \textcolor{stringliteral}{r"{}\string^\(\backslash\)s*QUIET\(\backslash\)s*=.*\$"{}},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00178}00178         \textcolor{stringliteral}{"{}QUIET="{}} + \textcolor{stringliteral}{"{}YES"{}} \textcolor{keywordflow}{if} silent \textcolor{keywordflow}{else} \textcolor{stringliteral}{"{}NO"{}},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00179}00179         content,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00180}00180         flags=re.MULTILINE,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00181}00181     )}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00182}00182 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00183}00183     \textcolor{keywordflow}{if} fmt:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00184}00184         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} fmt\_pattern \textcolor{keywordflow}{or} \textcolor{keywordflow}{not} fmt\_vars:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00185}00185             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}Invalid formatting pattern or variables"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00186}00186 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00187}00187         \textcolor{keywordflow}{if} outdir\_var:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00188}00188             fmt\_vars = fmt\_vars.copy()}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00189}00189             fmt\_vars[outdir\_var] = outdir.as\_posix()}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00190}00190 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00191}00191         \textcolor{keywordflow}{for} var, value \textcolor{keywordflow}{in} fmt\_vars.items():}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00192}00192             content = content.replace(fmt\_pattern.format(var), value)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00193}00193 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00194}00194     \textcolor{keywordflow}{return} content}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00196}00196 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00197}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a2282acf52f6f3efb22f67f55d2d6cc35}{00197}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a2282acf52f6f3efb22f67f55d2d6cc35}{doxygen\_input\_has\_changed}}(env: BuildEnvironment, doxyfile: str) -\/> bool:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00198}00198     \textcolor{stringliteral}{"{}"{}"{}Check if Doxygen input files have changed.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00199}00199 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00200}00200 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00201}00201 \textcolor{stringliteral}{        env: Sphinx build environment instance.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00202}00202 \textcolor{stringliteral}{        doxyfile: Doxyfile content.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00203}00203 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00204}00204 \textcolor{stringliteral}{    Returns:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00205}00205 \textcolor{stringliteral}{        }\textcolor{keyword}{True} \textcolor{keywordflow}{if} changed, \textcolor{keyword}{False} otherwise.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00206}00206     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00207}00207 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00208}00208 \textcolor{stringliteral}{    }\textcolor{comment}{\# obtain Doxygen input files and patterns}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00209}00209     input\_files = \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_add0d4523ccd979592c439a29fbda0cea}{get\_doxygen\_option}}(doxyfile, \textcolor{stringliteral}{"{}INPUT"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00210}00210     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} input:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00211}00211         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}No INPUT set in Doxyfile"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00212}00212 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00213}00213     file\_patterns = \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_add0d4523ccd979592c439a29fbda0cea}{get\_doxygen\_option}}(doxyfile, \textcolor{stringliteral}{"{}FILE\_PATTERNS"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00214}00214     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} file\_patterns:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00215}00215         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}No FILE\_PATTERNS set in Doxyfile"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00216}00216 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00217}00217     \textcolor{comment}{\# build a set with input files hash}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00218}00218     cache = set()}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00219}00219     \textcolor{keywordflow}{for} file \textcolor{keywordflow}{in} input\_files:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00220}00220         path = Path(file)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00221}00221         \textcolor{keywordflow}{if} path.is\_file():}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00222}00222             cache.add(\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a7a7998d5bf92a041ce74e5065b6fc255}{hash\_file}}(path))}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00223}00223         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00224}00224             \textcolor{keywordflow}{for} pattern \textcolor{keywordflow}{in} file\_patterns:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00225}00225                 \textcolor{keywordflow}{for} p\_file \textcolor{keywordflow}{in} path.glob(\textcolor{stringliteral}{"{}**/"{}} + pattern):}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00226}00226                     cache.add(\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a7a7998d5bf92a041ce74e5065b6fc255}{hash\_file}}(p\_file))}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00227}00227 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00228}00228     \textcolor{comment}{\# check if any file has changed}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00229}00229     \textcolor{keywordflow}{if} hasattr(env, \textcolor{stringliteral}{"{}doxyrunner\_cache"{}}) \textcolor{keywordflow}{and} env.doxyrunner\_cache == cache:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00230}00230         \textcolor{keywordflow}{return} \textcolor{keyword}{False}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00231}00231 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00232}00232     \textcolor{comment}{\# store current state}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00233}00233     env.doxyrunner\_cache = cache}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00234}00234 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00235}00235     \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00236}00236 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00237}00237 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00238}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_aee1e58ce0153518b6f927baa2bf7f94d}{00238}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_aee1e58ce0153518b6f927baa2bf7f94d}{process\_doxygen\_output}}(line: str, silent: bool) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00239}00239     \textcolor{stringliteral}{"{}"{}"{}Process a line of Doxygen program output.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00240}00240 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00241}00241 \textcolor{stringliteral}{    This function will map Doxygen output to the Sphinx logger output. Errors}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00242}00242 \textcolor{stringliteral}{    }\textcolor{keywordflow}{and} warnings will be converted to Sphinx errors \textcolor{keywordflow}{and} warnings. Other}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00243}00243     messages, \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} silent, will be mapped to the info logger channel.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00244}00244 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00245}00245     Args:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00246}00246         line: Doxygen program line.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00247}00247         silent: \textcolor{keyword}{True} \textcolor{keywordflow}{if} regular messages should be logged, \textcolor{keyword}{False} otherwise.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00248}00248     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00249}00249 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00250}00250 \textcolor{stringliteral}{    m = re.match(r"{}(.*):(\(\backslash\)d+): ([a-\/z]+): (.*)"{}}, line)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00251}00251     \textcolor{keywordflow}{if} m:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00252}00252         type = m.group(3)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00253}00253         message = f\textcolor{stringliteral}{"{}\{m.group(1)\}:\{m.group(2)\}: \{m.group(4)\}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00254}00254         \textcolor{keywordflow}{if} type == \textcolor{stringliteral}{"{}error"{}}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00255}00255             logger.error(message)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00256}00256         \textcolor{keywordflow}{elif} type == \textcolor{stringliteral}{"{}warning"{}}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00257}00257             logger.warning(message)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00258}00258         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00259}00259             logger.info(message)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00260}00260     \textcolor{keywordflow}{elif} \textcolor{keywordflow}{not} silent:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00261}00261         logger.info(line)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00262}00262 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00264}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a96e0a0af9f69b456ef3099423ada9d0c}{00264}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a96e0a0af9f69b456ef3099423ada9d0c}{run\_doxygen}}(doxygen: str, doxyfile: str, silent: bool = \textcolor{keyword}{False}) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00265}00265     \textcolor{stringliteral}{"{}"{}"{}Run Doxygen build.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00266}00266 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00267}00267 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00268}00268 \textcolor{stringliteral}{        doxygen: Path to Doxygen binary.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00269}00269 \textcolor{stringliteral}{        doxyfile: Doxyfile content.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00270}00270 \textcolor{stringliteral}{        silent: If Doxygen output should be logged }\textcolor{keywordflow}{or} \textcolor{keywordflow}{not}.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00271}00271     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00272}00272 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00273}00273 \textcolor{stringliteral}{    f\_doxyfile = tempfile.NamedTemporaryFile("{}w"{}}, delete=\textcolor{keyword}{False})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00274}00274     f\_doxyfile.write(doxyfile)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00275}00275     f\_doxyfile.close()}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00276}00276 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00277}00277     p = Popen([doxygen, f\_doxyfile.name], stdout=PIPE, stderr=STDOUT, encoding=\textcolor{stringliteral}{"{}utf-\/8"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00278}00278     \textcolor{keywordflow}{while} \textcolor{keyword}{True}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00279}00279         line = p.stdout.readline()  \textcolor{comment}{\# type: ignore}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00280}00280         \textcolor{keywordflow}{if} line:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00281}00281             \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_aee1e58ce0153518b6f927baa2bf7f94d}{process\_doxygen\_output}}(line.rstrip(), silent)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00282}00282         \textcolor{keywordflow}{if} p.poll() \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00283}00283             \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00284}00284 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00285}00285     Path(f\_doxyfile.name).unlink()}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00286}00286 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00287}00287     \textcolor{keywordflow}{if} p.returncode:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00288}00288         \textcolor{keywordflow}{raise} IOError(f\textcolor{stringliteral}{"{}Doxygen process returned non-\/zero (\{p.returncode\})"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00289}00289 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00290}00290 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00291}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a44d3521eb3f94b14a5b90006200b533d}{00291}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a44d3521eb3f94b14a5b90006200b533d}{sync\_doxygen}}(doxyfile: str, new: Path, prev: Path) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00292}00292     \textcolor{stringliteral}{"{}"{}"{}Synchronize Doxygen output with a previous build.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00293}00293 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00294}00294 \textcolor{stringliteral}{    This function makes sure that only new, deleted }\textcolor{keywordflow}{or} changed files are}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00295}00295     actually modified \textcolor{keywordflow}{in} the Doxygen XML output. Latest HTML content \textcolor{keywordflow}{is} just}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00296}00296     moved.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00297}00297 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00298}00298     Args:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00299}00299         doxyfile: Contents of the Doxyfile.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00300}00300         new: Newest Doxygen build output directory.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00301}00301         prev: Previous Doxygen build output directory.}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00302}00302     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00303}00303 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00304}00304 \textcolor{stringliteral}{    generate\_html = \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_add0d4523ccd979592c439a29fbda0cea}{get\_doxygen\_option}}(doxyfile, "{}GENERATE\_HTML"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00305}00305     \textcolor{keywordflow}{if} generate\_html[0] == \textcolor{stringliteral}{"{}YES"{}}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00306}00306         html\_output = \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_add0d4523ccd979592c439a29fbda0cea}{get\_doxygen\_option}}(doxyfile, \textcolor{stringliteral}{"{}HTML\_OUTPUT"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00307}00307         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} html\_output:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00308}00308             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}No HTML\_OUTPUT set in Doxyfile"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00309}00309 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00310}00310         new\_htmldir = new / html\_output[0]}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00311}00311         prev\_htmldir = prev / html\_output[0]}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00312}00312 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00313}00313         \textcolor{keywordflow}{if} prev\_htmldir.exists():}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00314}00314             shutil.rmtree(prev\_htmldir)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00315}00315         new\_htmldir.rename(prev\_htmldir)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00316}00316 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00317}00317     xml\_output = \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_add0d4523ccd979592c439a29fbda0cea}{get\_doxygen\_option}}(doxyfile, \textcolor{stringliteral}{"{}XML\_OUTPUT"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00318}00318     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} xml\_output:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00319}00319         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"{}No XML\_OUTPUT set in Doxyfile"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00320}00320 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00321}00321     new\_xmldir = new / xml\_output[0]}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00322}00322     prev\_xmldir = prev / xml\_output[0]}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00323}00323 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00324}00324     \textcolor{keywordflow}{if} prev\_xmldir.exists():}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00325}00325         dcmp = filecmp.dircmp(new\_xmldir, prev\_xmldir)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00326}00326 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00327}00327         \textcolor{keywordflow}{for} file \textcolor{keywordflow}{in} dcmp.right\_only:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00328}00328             (Path(dcmp.right) / file).unlink()}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00329}00329 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00330}00330         \textcolor{keywordflow}{for} file \textcolor{keywordflow}{in} dcmp.left\_only + dcmp.diff\_files:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00331}00331             shutil.copy(Path(dcmp.left) / file, Path(dcmp.right) / file)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00332}00332 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00333}00333         shutil.rmtree(new\_xmldir)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00334}00334     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00335}00335         new\_xmldir.rename(prev\_xmldir)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00336}00336 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00337}00337 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00338}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_ae24135bba2016e4bfe52cfd185200570}{00338}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_ae24135bba2016e4bfe52cfd185200570}{doxygen\_build}}(app: Sphinx) -\/> \textcolor{keywordtype}{None}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00339}00339     \textcolor{stringliteral}{"{}"{}"{}Doxyrunner entry point.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00340}00340 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00341}00341 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00342}00342 \textcolor{stringliteral}{        app: Sphinx application instance.}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00343}00343 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00344}00344 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00345}00345 \textcolor{stringliteral}{    }\textcolor{keywordflow}{if} app.config.doxyrunner\_outdir:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00346}00346         outdir = Path(app.config.doxyrunner\_outdir)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00347}00347     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00348}00348         outdir = Path(app.outdir) / \textcolor{stringliteral}{"{}\_doxygen"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00349}00349 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00350}00350     outdir.mkdir(exist\_ok=\textcolor{keyword}{True})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00351}00351     tmp\_outdir = outdir / \textcolor{stringliteral}{"{}tmp"{}}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00352}00352 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00353}00353     logger.info(\textcolor{stringliteral}{"{}Preparing Doxyfile..."{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00354}00354     doxyfile = \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_abda974c7596f863ebd4f4820cb1b8deb}{process\_doxyfile}}(}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00355}00355         app.config.doxyrunner\_doxyfile,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00356}00356         tmp\_outdir,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00357}00357         app.config.doxyrunner\_silent,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00358}00358         app.config.doxyrunner\_fmt,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00359}00359         app.config.doxyrunner\_fmt\_pattern,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00360}00360         app.config.doxyrunner\_fmt\_vars,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00361}00361         app.config.doxyrunner\_outdir\_var,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00362}00362     )}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00364}00364     logger.info(\textcolor{stringliteral}{"{}Checking if Doxygen needs to be run..."{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00365}00365     changed = \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a2282acf52f6f3efb22f67f55d2d6cc35}{doxygen\_input\_has\_changed}}(app.env, doxyfile)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00366}00366     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} changed:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00367}00367         logger.info(\textcolor{stringliteral}{"{}Doxygen build will be skipped (no changes)!"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00368}00368         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00369}00369 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00370}00370     logger.info(\textcolor{stringliteral}{"{}Running Doxygen..."{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00371}00371     \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a96e0a0af9f69b456ef3099423ada9d0c}{run\_doxygen}}(}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00372}00372         app.config.doxyrunner\_doxygen,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00373}00373         doxyfile,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00374}00374         app.config.doxyrunner\_silent,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00375}00375     )}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00377}00377     logger.info(\textcolor{stringliteral}{"{}Syncing Doxygen output..."{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00378}00378     \mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a44d3521eb3f94b14a5b90006200b533d}{sync\_doxygen}}(doxyfile, tmp\_outdir, outdir)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00379}00379 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00380}00380     shutil.rmtree(tmp\_outdir)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00381}00381 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00382}00382 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00383}\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a85508e83c273440ec9a810e463622628}{00383}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1doxyrunner_a85508e83c273440ec9a810e463622628}{setup}}(app: Sphinx) -\/> Dict[str, Any]:}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00384}00384     app.add\_config\_value(\textcolor{stringliteral}{"{}doxyrunner\_doxygen"{}}, \textcolor{stringliteral}{"{}doxygen"{}}, \textcolor{stringliteral}{"{}env"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00385}00385     app.add\_config\_value(\textcolor{stringliteral}{"{}doxyrunner\_doxyfile"{}}, \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"{}env"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00386}00386     app.add\_config\_value(\textcolor{stringliteral}{"{}doxyrunner\_outdir"{}}, \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"{}env"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00387}00387     app.add\_config\_value(\textcolor{stringliteral}{"{}doxyrunner\_outdir\_var"{}}, \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"{}env"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00388}00388     app.add\_config\_value(\textcolor{stringliteral}{"{}doxyrunner\_fmt"{}}, \textcolor{keyword}{False}, \textcolor{stringliteral}{"{}env"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00389}00389     app.add\_config\_value(\textcolor{stringliteral}{"{}doxyrunner\_fmt\_vars"{}}, \{\}, \textcolor{stringliteral}{"{}env"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00390}00390     app.add\_config\_value(\textcolor{stringliteral}{"{}doxyrunner\_fmt\_pattern"{}}, \textcolor{stringliteral}{"{}@\{\}@"{}}, \textcolor{stringliteral}{"{}env"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00391}00391     app.add\_config\_value(\textcolor{stringliteral}{"{}doxyrunner\_silent"{}}, \textcolor{keyword}{True}, \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00392}00392 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00393}00393     app.connect(\textcolor{stringliteral}{"{}builder-\/inited"{}}, doxygen\_build)}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00394}00394 }
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00395}00395     \textcolor{keywordflow}{return} \{}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00396}00396         \textcolor{stringliteral}{"{}version"{}}: \_\_version\_\_,}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00397}00397         \textcolor{stringliteral}{"{}parallel\_read\_safe"{}}: \textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00398}00398         \textcolor{stringliteral}{"{}parallel\_write\_safe"{}}: \textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{doxyrunner_8py_source_l00399}00399     \}}

\end{DoxyCode}
