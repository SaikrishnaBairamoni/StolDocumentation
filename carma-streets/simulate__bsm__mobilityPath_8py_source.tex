\hypertarget{simulate__bsm__mobilityPath_8py_source}{}\doxysection{simulate\+\_\+bsm\+\_\+mobility\+Path.\+py}
\label{simulate__bsm__mobilityPath_8py_source}\index{scripts/simulate\_bsm\_mobilityPath.py@{scripts/simulate\_bsm\_mobilityPath.py}}
\mbox{\hyperlink{simulate__bsm__mobilityPath_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00001}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath}{00001}} \textcolor{keyword}{from} os \textcolor{keyword}{import} read}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00002}00002 \textcolor{keyword}{from} kafka \textcolor{keyword}{import} KafkaProducer}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00003}00003 \textcolor{keyword}{import} time}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00004}00004 \textcolor{keyword}{from} time \textcolor{keyword}{import} sleep}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00005}00005 \textcolor{keyword}{import} json}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00006}00006 \textcolor{keyword}{import} threading}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00008}00008 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00009}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_ace2996b1d43cb18357a557fbdfb756be}{00009}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_ace2996b1d43cb18357a557fbdfb756be}{read\_json}}(json\_name):}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00010}00010     data = \{\}}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00011}00011     \textcolor{keyword}{with} open(json\_name, \textcolor{stringliteral}{"{}r"{}}) \textcolor{keyword}{as} json\_file:}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00012}00012         data = json.load(json\_file)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00013}00013     \textcolor{keywordflow}{return} data}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00014}00014 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00015}00015 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00016}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_aff7389152d48d7cfc225f5e58d9f9cd6}{00016}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_aff7389152d48d7cfc225f5e58d9f9cd6}{produce\_bsm}}():}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00017}00017     producer = KafkaProducer(bootstrap\_servers=[\textcolor{stringliteral}{"{}127.0.0.1:9092"{}}],}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00018}00018                              value\_serializer=\textcolor{keyword}{lambda} x: json.dumps(x).encode(\textcolor{stringliteral}{'utf-\/8'}))}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00019}00019     count = 10}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00020}00020     i = 0}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00021}00021     while(i < count):}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00022}00022         data = \mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_ace2996b1d43cb18357a557fbdfb756be}{read\_json}}(\textcolor{stringliteral}{'bsm.json'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00023}00023         data[\textcolor{stringliteral}{"{}core\_data"{}}][\textcolor{stringliteral}{"{}msg\_count"{}}] = str(i)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00024}00024         data[\textcolor{stringliteral}{"{}core\_data"{}}][\textcolor{stringliteral}{"{}speed"{}}] = str(i)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00025}00025         producer.send(\textcolor{stringliteral}{'v2xhub\_bsm\_in'}, value=data)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00026}00026         print(\textcolor{stringliteral}{'Sent a bsm.'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00027}00027         i += 1}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00028}00028         producer.flush()}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00031}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_a8b0c3734bfaf2eba5774e0c661ef1b26}{00031}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_a8b0c3734bfaf2eba5774e0c661ef1b26}{produce\_mobility\_path}}():}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00032}00032     producer = KafkaProducer(bootstrap\_servers=[\textcolor{stringliteral}{"{}127.0.0.1:9092"{}}],}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00033}00033                              value\_serializer=\textcolor{keyword}{lambda} x: json.dumps(x).encode(\textcolor{stringliteral}{'utf-\/8'}))}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00034}00034     i = 0}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00035}00035     count = 10}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00036}00036     while(i < count):}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00037}00037         data = \mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_ace2996b1d43cb18357a557fbdfb756be}{read\_json}}(\textcolor{stringliteral}{'mobilitypath.json'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00038}00038         timestamp = int(data[\textcolor{stringliteral}{"{}metadata"{}}][\textcolor{stringliteral}{"{}timestamp"{}}]) + i}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00039}00039         data[\textcolor{stringliteral}{"{}metadata"{}}][\textcolor{stringliteral}{"{}timestamp"{}}] = str(timestamp)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00040}00040         producer.send(\textcolor{stringliteral}{'v2xhub\_mobility\_path\_in'}, value=data)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00041}00041         print(\textcolor{stringliteral}{'Sent a mobilitypath.'})}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00042}00042         i += 1}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00043}00043         producer.flush()}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00046}00046 \textcolor{keywordflow}{if} \_\_name\_\_ == \textcolor{stringliteral}{"{}\_\_main\_\_"{}}:}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00047}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_a0ac30f65e0e1acdb652f7ae3601496d1}{00047}}     bsm\_th = threading.Thread(target=produce\_bsm)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00048}\mbox{\hyperlink{namespacesimulate__bsm__mobilityPath_af3cd0976597aac0be83816360c7f8674}{00048}}     mobility\_path\_th = threading.Thread(target=produce\_mobility\_path)}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00049}00049     mobility\_path\_th.start()}
\DoxyCodeLine{\Hypertarget{simulate__bsm__mobilityPath_8py_source_l00050}00050     bsm\_th.start()}

\end{DoxyCode}
