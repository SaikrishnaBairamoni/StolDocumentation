\hypertarget{vcs__link_8py_source}{}\doxysection{vcs\+\_\+link.\+py}
\label{vcs__link_8py_source}\index{doc/\_extensions/zephyr/vcs\_link.py@{doc/\_extensions/zephyr/vcs\_link.py}}
\mbox{\hyperlink{vcs__link_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00001}\mbox{\hyperlink{namespacezephyr_1_1vcs__link}{00001}} \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00002}00002 \textcolor{stringliteral}{VCS Link}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00003}00003 \textcolor{stringliteral}{\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00004}00004 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00005}00005 \textcolor{stringliteral}{Copyright (c) 2021 Nordic Semiconductor ASA}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00006}00006 \textcolor{stringliteral}{SPDX-\/License-\/Identifier: Apache-\/2.0}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00007}00007 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00008}00008 \textcolor{stringliteral}{Introduction}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00009}00009 \textcolor{stringliteral}{============}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00010}00010 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00011}00011 \textcolor{stringliteral}{This Sphinx extension can be used to obtain the VCS URL for a given Sphinx page.}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00012}00012 \textcolor{stringliteral}{This is useful, for example, when adding features like "{}Open on GitHub"{} on top}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00013}00013 \textcolor{stringliteral}{of pages. The extension installs a Jinja filter which can be used on the}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00014}00014 \textcolor{stringliteral}{template to obtain VCS page URLs.}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00015}00015 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00016}00016 \textcolor{stringliteral}{Configuration options}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00017}00017 \textcolor{stringliteral}{=====================}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00018}00018 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00019}00019 \textcolor{stringliteral}{-\/ ``vcs\_link\_base\_url``: Base URL used as a prefix for generated URLs.}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00020}00020 \textcolor{stringliteral}{-\/ ``vcs\_link\_prefixes``: Mapping of pages (regex) <> VCS prefix.}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00021}00021 \textcolor{stringliteral}{-\/ ``vcs\_link\_exclude``: List of pages (regex) that will not report a URL. Useful}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00022}00022 \textcolor{stringliteral}{  }\textcolor{keywordflow}{for}, e.g., auto-\/generated pages \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} VCS.}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00023}00023 \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00024}00024 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00025}00025 \textcolor{stringliteral}{from functools import partial}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00026}00026 \textcolor{stringliteral}{import os}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00027}00027 \textcolor{stringliteral}{import re}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00028}00028 \textcolor{stringliteral}{from typing import Optional}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00029}00029 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00030}00030 \textcolor{stringliteral}{from sphinx.application import Sphinx}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00031}00031 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00032}00032 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00033}\mbox{\hyperlink{namespacezephyr_1_1vcs__link_a14eaa8e7f04f3765da3e755069ecb836}{00033}} \textcolor{stringliteral}{\_\_version\_\_ = "{}0.1.0"{}}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00034}00034 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00035}00035 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00036}\mbox{\hyperlink{namespacezephyr_1_1vcs__link_a356627d8c6161117de52b5e45793ab20}{00036}} \textcolor{stringliteral}{def vcs\_link\_get\_url(app: Sphinx, pagename: str) -\/> Optional[str]:}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00037}00037 \textcolor{stringliteral}{    "{}"{}"{}Obtain VCS URL for the given page.}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00038}00038 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00039}00039 \textcolor{stringliteral}{    Args:}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00040}00040 \textcolor{stringliteral}{        app: Sphinx instance.}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00041}00041 \textcolor{stringliteral}{        pagename: Page name (path).}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00042}00042 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00043}00043 \textcolor{stringliteral}{    Returns:}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00044}00044 \textcolor{stringliteral}{        VCS URL }\textcolor{keywordflow}{if} applicable, \textcolor{keywordtype}{None} otherwise.}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00045}00045     \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00046}00046 \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00047}00047 \textcolor{stringliteral}{    }\textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.isfile(app.env.project.doc2path(pagename)):}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00048}00048         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00050}00050     \textcolor{keywordflow}{for} exclude \textcolor{keywordflow}{in} app.config.vcs\_link\_exclude:}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00051}00051         \textcolor{keywordflow}{if} re.match(exclude, pagename):}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00052}00052             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00054}00054     found\_prefix = \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00055}00055     \textcolor{keywordflow}{for} pattern, prefix \textcolor{keywordflow}{in} app.config.vcs\_link\_prefixes.items():}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00056}00056         \textcolor{keywordflow}{if} re.match(pattern, pagename):}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00057}00057             found\_prefix = prefix}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00058}00058             \textcolor{keywordflow}{break}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00060}00060     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"{}/"{}}.join(}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00061}00061         [}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00062}00062             app.config.vcs\_link\_base\_url,}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00063}00063             found\_prefix,}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00064}00064             app.env.project.doc2path(pagename, basedir=\textcolor{keyword}{False}),}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00065}00065         ]}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00066}00066     )}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00068}00068 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00069}\mbox{\hyperlink{namespacezephyr_1_1vcs__link_a5560a238ab32063bbda716cb803beac1}{00069}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1vcs__link_a5560a238ab32063bbda716cb803beac1}{add\_jinja\_filter}}(app: Sphinx):}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00070}00070     \textcolor{keywordflow}{if} app.builder.name != \textcolor{stringliteral}{"{}html"{}}:}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00071}00071         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00072}00072 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00073}00073     app.builder.templates.environment.filters[\textcolor{stringliteral}{"{}vcs\_link\_get\_url"{}}] = partial(}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00074}00074         vcs\_link\_get\_url, app}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00075}00075     )}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00078}\mbox{\hyperlink{namespacezephyr_1_1vcs__link_a3f68721b97db3331f1f3e0061872fed7}{00078}} \textcolor{keyword}{def }\mbox{\hyperlink{namespacezephyr_1_1vcs__link_a3f68721b97db3331f1f3e0061872fed7}{setup}}(app: Sphinx):}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00079}00079     app.add\_config\_value(\textcolor{stringliteral}{"{}vcs\_link\_base\_url"{}}, \textcolor{stringliteral}{"{}"{}}, \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00080}00080     app.add\_config\_value(\textcolor{stringliteral}{"{}vcs\_link\_prefixes"{}}, \{\}, \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00081}00081     app.add\_config\_value(\textcolor{stringliteral}{"{}vcs\_link\_exclude"{}}, [], \textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00082}00082 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00083}00083     app.connect(\textcolor{stringliteral}{"{}builder-\/inited"{}}, add\_jinja\_filter)}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00085}00085     \textcolor{keywordflow}{return} \{}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00086}00086         \textcolor{stringliteral}{"{}version"{}}: \_\_version\_\_,}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00087}00087         \textcolor{stringliteral}{"{}parallel\_read\_safe"{}}: \textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00088}00088         \textcolor{stringliteral}{"{}parallel\_write\_safe"{}}: \textcolor{keyword}{True},}
\DoxyCodeLine{\Hypertarget{vcs__link_8py_source_l00089}00089     \}}

\end{DoxyCode}
